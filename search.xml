<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Linux CentOS升级安装git</title>
      <link href="2020/12/14/Linux%20CentOS%E5%8D%87%E7%BA%A7%E5%AE%89%E8%A3%85git%20/"/>
      <url>2020/12/14/Linux%20CentOS%E5%8D%87%E7%BA%A7%E5%AE%89%E8%A3%85git%20/</url>
      
        <content type="html"><![CDATA[<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>CentOS默认的yum安装git版本是1.8，但我们想升级它，需要自己去编译安装</p><h4 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h4><ul><li>首先安装依赖<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install gcc</span><br><span class="line">yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel</span><br><span class="line">yum install gcc perl-ExtUtils-MakeMaker</span><br></pre></td></tr></table></figure></li></ul><h4 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h4><ul><li><p>前往<a href="https://mirrors.edge.kernel.org/pub/software/scm/git/">镜像网站</a>手动去下载git，或者我们可以用wget下载目前最新的2.9.5</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://mirrors.edge.kernel.org/pub/software/scm/git/git-2.9.5.tar.gz</span><br></pre></td></tr></table></figure></li><li><p>解压</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxf git-2.9.5.tar.gz</span><br></pre></td></tr></table></figure></li><li><p>进入目录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd git-2.9.5</span><br></pre></td></tr></table></figure></li><li><p>配置检测，并且设置安装目录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/usr/local/git</span><br></pre></td></tr></table></figure></li><li><p>编译安装</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure></li></ul><h4 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h4><p>我们需要配置环境变量才能全局使用git命令</p><ul><li>在profile里配置环境变量<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;export PATH=$PATH:/usr/local/git/bin&#x27; &gt; /etc/profile.d/git.sh</span><br></pre></td></tr></table></figure></li><li>刷新环境变量，使其生效<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>OK<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-0-11-centos git-2.9.5]# git --version</span><br><span class="line">git version 2.9.5</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> 服务器 </category>
          
          <category> git </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Hexo部署GitHub Pages</title>
      <link href="2020/12/11/Hexo%E9%83%A8%E7%BD%B2GitHub-Pages/"/>
      <url>2020/12/11/Hexo%E9%83%A8%E7%BD%B2GitHub-Pages/</url>
      
        <content type="html"><![CDATA[<h4 id="环境要求"><a href="#环境要求" class="headerlink" title="环境要求"></a>环境要求</h4><ul><li>node.js  &gt; 10.13</li><li>git</li><li><a href="https://hexo.io/zh-cn/docs/">Hexo</a></li><li>默认你知道Hexo的使用方法</li></ul><h4 id="创建一个仓库-repository"><a href="#创建一个仓库-repository" class="headerlink" title="创建一个仓库(repository)"></a>创建一个仓库(repository)</h4><ul><li><p>进入GitHub，右上角点击 <a href="https://github.com/new"> New repository</a></p></li><li><p>将Repository name设置成   <code>你的用户名.github.io</code> ，注意，用户名必须跟你的一模一样</p></li><li><p>复制GitHub连接 <code>git@github.com:Chenilove/Chenilove.github.io.git</code> ，注意这里用HTTPS的话每次提交都要登录，推荐SSH</p></li><li><p>在Hexo项目根目录下，编辑<code>_config.yml</code>文件，里面修改</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/one-command-deployment</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">git</span> <span class="comment"># 提交类型git</span></span><br><span class="line">    <span class="attr">repo:</span> <span class="string">git@github.com:Chenilove/Chenilove.github.io.git</span> <span class="comment"># 提交仓库地址</span></span><br><span class="line">    <span class="attr">branch:</span> <span class="string">main</span> <span class="comment"># 分支GitHub的默认分支是main Gitee的分支是master 可以填branch让hexo默认提交</span></span><br><span class="line">    <span class="attr">message:</span> <span class="string">message</span> <span class="comment"># 提交信息</span></span><br></pre></td></tr></table></figure></li><li><p>执行项目生成和部署命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure></li><li><p>最后访问 <a href="https://chenilove.github.io/">https://chenilove.github.io/</a> 就可以了</p></li></ul><h4 id="issues"><a href="#issues" class="headerlink" title="issues"></a>issues</h4><ul><li><p>执行<code>hexo d</code>每次都要登录是怎么回事?</p><p>将<code>_config.yml</code>里的<code>repo</code>改成SSH（<a href="mailto:&#x67;&#x69;&#116;&#x40;&#103;&#105;&#x74;&#104;&#117;&#x62;&#x2e;&#x63;&#x6f;&#x6d;">&#x67;&#x69;&#116;&#x40;&#103;&#105;&#x74;&#104;&#117;&#x62;&#x2e;&#x63;&#x6f;&#x6d;</a>）的链接就行了</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
          <category> Hexo </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Linux关闭watchdog</title>
      <link href="2020/12/04/Linux%E5%85%B3%E9%97%ADwatchdog/"/>
      <url>2020/12/04/Linux%E5%85%B3%E9%97%ADwatchdog/</url>
      
        <content type="html"><![CDATA[<h3 id="sysctl命令控制"><a href="#sysctl命令控制" class="headerlink" title="sysctl命令控制"></a>sysctl命令控制</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用该命令直接关闭，值改为1时开启</span></span><br><span class="line"></span><br><span class="line">sysctl kernel.nmi_watchdog=0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在/etc/sysctl.conf中增加如下内容，开机自动关闭</span></span><br><span class="line"></span><br><span class="line">kernel.nmi_watchdog = 0</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 服务器 </category>
          
          <category> Linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>MySQL SELECT list is not in...MySQL关闭严格模式</title>
      <link href="2020/12/04/MySQL%20SELECT%20list%20is%20not%20in...MySQL%E5%85%B3%E9%97%AD%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F/"/>
      <url>2020/12/04/MySQL%20SELECT%20list%20is%20not%20in...MySQL%E5%85%B3%E9%97%AD%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p> SELECT list is not inGROUP BY clause and contains nonaggregated column<br>MySQL严格模式主要用以下场景</p><ul><li>  不支持对not null字段插入null值</li><li>  不支持对自增长字段插入”值</li><li>  不支持text字段有默认值</li></ul><p>我们用不到时可以关闭它，在Laravel中可以编辑database.php，关闭严格模式，不使用框架时，可以编辑my.ini<br>在[mysqld]加一行</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">sql-mode=&quot;&quot;</span><br></pre></td></tr></table></figure><p>重启MySQL，就关闭了</p>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
          <category> MySQL </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>linux与windows下 安装 ImageMagick 及其 php imagick扩展</title>
      <link href="2020/11/04/linux%E4%B8%8Ewindows%E4%B8%8B%20%E5%AE%89%E8%A3%85%20ImageMagick%20%E5%8F%8A%E5%85%B6%20php%20imagick%E6%89%A9%E5%B1%95/"/>
      <url>2020/11/04/linux%E4%B8%8Ewindows%E4%B8%8B%20%E5%AE%89%E8%A3%85%20ImageMagick%20%E5%8F%8A%E5%85%B6%20php%20imagick%E6%89%A9%E5%B1%95/</url>
      
        <content type="html"><![CDATA[<p>首先要安装两个东西，一个是<a href="http://www.imagemagick.org/script/install-source.php">ImageMagick</a>，另一个是PHP扩展<a href="https://pecl.php.net/package/imagick">imagick</a></p><h1 id="Linux安装"><a href="#Linux安装" class="headerlink" title="Linux安装"></a>Linux安装</h1><h3 id="先安装ImageMagick"><a href="#先安装ImageMagick" class="headerlink" title="先安装ImageMagick"></a>先安装ImageMagick</h3><ul><li>下载ImageMagick安装包<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://www.imagemagick.org/download/ImageMagick.tar.gz</span><br></pre></td></tr></table></figure></li><li>解压<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xvfz ImageMagick.tar.gz</span><br></pre></td></tr></table></figure></li><li>进入目录<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ImageMagick-7.0.10-28</span><br></pre></td></tr></table></figure></li><li>设置安装路径.后面安装php扩展需要用到;/usr/local/imagemagick<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/usr/<span class="built_in">local</span>/imagemagick</span><br></pre></td></tr></table></figure></li><li>编译<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><h3 id="PHP-imagick扩展安装（第二步）"><a href="#PHP-imagick扩展安装（第二步）" class="headerlink" title="PHP imagick扩展安装（第二步）"></a>PHP imagick扩展安装（第二步）</h3>官网地址：<a href="http://pecl.php.net/package/imagick">http://pecl.php.net/package/imagick</a></li><li>下载imagick-3.4.4<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://pecl.php.net/get/imagick-3.4.4.tgz</span><br></pre></td></tr></table></figure></li><li>解压安装包<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf imagick-3.4.4.tgz</span><br></pre></td></tr></table></figure></li><li>进入安装文件<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> imagick-3.4.4.tgz/</span><br></pre></td></tr></table></figure></li><li>执行phpize命令<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/<span class="built_in">local</span>/php/bin/phpize</span><br></pre></td></tr></table></figure></li><li>ImageMagick 6.8以上版本目录为/usr/local/include/ImageMagick-X,在configure之前先做下软连接<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s /usr/<span class="built_in">local</span>/imagemagick/include/ImageMagick-7 /usr/<span class="built_in">local</span>/imagemagick/include/ImageMagick</span><br></pre></td></tr></table></figure></li><li>执行configure配置<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure --with-php-config=/usr/<span class="built_in">local</span>/php/bin/php-config --with-imagick=/usr/<span class="built_in">local</span>/imagemagick</span><br></pre></td></tr></table></figure></li><li>编译<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure></li><li>php.ini加入imagick.so<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">extensions=imagick.so</span><br></pre></td></tr></table></figure></li></ul><h1 id="Windows下安装"><a href="#Windows下安装" class="headerlink" title="Windows下安装"></a>Windows下安装</h1><p><a href="https://blog.csdn.net/weixin_44694538/article/details/104985567">原文链接</a></p><ul><li>要下载扩展，需要清楚自己的PHP版本。通过phpinfo（）查看.<br><img src="https://cdn.learnku.com/uploads/images/202008/28/34227/RdgMmbrgTH.jpg!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202008/28/34227/RdgMmbrgTH.jpg!large" srcset="data:image/png;base64,666"><br>红框的信息之后会用到</li><li>下载imagemagick程序<br>地址:<a href="https://links.jianshu.com/go?to=http://windows.php.net/downloads/pecl/deps/">http://windows.php.net/downloads/pecl/deps/</a><br>下载这个区域里面的对应版本.选择最高版本，我需要下载vc15的64位的<br><img src="https://cdn.learnku.com/uploads/images/202008/28/34227/d1gyZYic4t.jpg!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202008/28/34227/d1gyZYic4t.jpg!large" srcset="data:image/png;base64,666"><h4 id="安装imagemagick程序"><a href="#安装imagemagick程序" class="headerlink" title="安装imagemagick程序"></a>安装imagemagick程序</h4></li><li>  把这个压缩包下载下来之后放到任意盘符。注意路径不要有中文和特殊字符。我是phpstudy集成环境，放在了<code>D:\phpstudy_pro\imagemagick</code>。这个是可以任意放置的。</li><li>  然后配置环境变量。参照下图<br><img src="https://cdn.learnku.com/uploads/images/202008/28/34227/riJu7Iu4bs.jpg!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202008/28/34227/riJu7Iu4bs.jpg!large" srcset="data:image/png;base64,666"><br>导入DLL文件<br>在下载的文件里面，进入到bin目录。然后搜索<code>.dll</code>把所有的文件复制到PHP的根目录下<br><img src="https://cdn.learnku.com/uploads/images/202008/28/34227/XnXsPqT0dE.jpg!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202008/28/34227/XnXsPqT0dE.jpg!large" srcset="data:image/png;base64,666"><br>搜索—全选–复制<br><img src="https://cdn.learnku.com/uploads/images/202008/28/34227/gKxwqXw1Yi.jpg!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202008/28/34227/gKxwqXw1Yi.jpg!large" srcset="data:image/png;base64,666"><br>搞定<h4 id="下载Imagick扩展"><a href="#下载Imagick扩展" class="headerlink" title="下载Imagick扩展"></a>下载Imagick扩展</h4>这里给出两个下载地址.如果不能用请再寻找<br>下载地址一: <a href="https://links.jianshu.com/go?to=http://windows.php.net/downloads/pecl/releases/imagick/">http://windows.php.net/downloads/pecl/releases/imagick/</a><br>下载地址二: <a href="https://links.jianshu.com/go?to=https://pecl.php.net/package/imagick">https://pecl.php.net/package/imagick</a><br><img src="https://cdn.learnku.com/uploads/images/202008/28/34227/fckRh59rlJ.jpg!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202008/28/34227/fckRh59rlJ.jpg!large" srcset="data:image/png;base64,666"></li><li>解压之后在最下面找到php_imagick.dll文件，复制到PHP根目录下的ext目录下<br><img src="https://cdn.learnku.com/uploads/images/202008/28/34227/RAeqT8lGpD.jpg!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202008/28/34227/RAeqT8lGpD.jpg!large" srcset="data:image/png;base64,666"></li><li>  其他<code>.DLL</code>文件 将解压后的<code>imagick</code>目录下的其他<code>.dll</code>后缀的文件全部复制粘贴到php根目录下</li><li>  <code>php.ini</code> 文件并打开编辑,加入<code>extension=php_imagick.dll</code>这一行<h1 id="重启服务"><a href="#重启服务" class="headerlink" title="重启服务"></a>重启服务</h1><img src="https://cdn.learnku.com/uploads/images/202008/28/34227/pMHXIr7WOv.jpg!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202008/28/34227/pMHXIr7WOv.jpg!large" srcset="data:image/png;base64,666"></li></ul>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
          <category> PHP </category>
          
          <category> 环境 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ThinkPHP里无法输出图片 设置响应头</title>
      <link href="2020/11/04/ThinkPHP%E9%87%8C%E6%97%A0%E6%B3%95%E8%BE%93%E5%87%BA%E5%9B%BE%E7%89%87%20%E8%AE%BE%E7%BD%AE%E5%93%8D%E5%BA%94%E5%A4%B4/"/>
      <url>2020/11/04/ThinkPHP%E9%87%8C%E6%97%A0%E6%B3%95%E8%BE%93%E5%87%BA%E5%9B%BE%E7%89%87%20%E8%AE%BE%E7%BD%AE%E5%93%8D%E5%BA%94%E5%A4%B4/</url>
      
        <content type="html"><![CDATA[<p>今天写了一个PHP生成图片，想用浏览器查看，但是每次打开都是一串乱码，看样子是图片源二进制数据，然后查看了下响应头是text/html，那我明明设置了image/jpeg</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">header(<span class="string">&quot;Content-type&quot;</span>, <span class="string">&quot;image/jpeg&quot;</span>);</span><br></pre></td></tr></table></figure><p>这说明TP默认设置了text/html，查了官方文档，啥也没说，去网上查，才知道TP有个Response类，默认所有控制器输出text/html，官方文档啥也没说，只好自己去翻Response这个类了</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ThinkPHP6\vendor\topthink\framework\src\think\Response.php</span><br></pre></td></tr></table></figure><p><img src="https://cdn.learnku.com/uploads/images/202008/22/34227/dLV0YonAiT.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202008/22/34227/dLV0YonAiT.png!large" srcset="data:image/png;base64,666"><br>基类Response被这几个类继承，我试了下File类，但是这个File是输出文件，浏览器直接下载了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$file</span> = <span class="keyword">new</span> File(<span class="string">&#x27;123.jpg&#x27;</span>);</span><br><span class="line"><span class="variable">$response</span> = <span class="variable">$file</span>-&gt;mimeType(<span class="string">&#x27;image/jpeg&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> HttpResponseException(<span class="variable">$response</span>);</span><br></pre></td></tr></table></figure><p>在看看基类Response</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 创建Response对象</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@access</span> public</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span>  mixed  $data 输出数据</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span>  string $type 输出类型</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span>  int    $code 状态码</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> Response</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">create</span>(<span class="params"><span class="variable">$data</span> = <span class="string">&#x27;&#x27;</span>, <span class="keyword">string</span> <span class="variable">$type</span> = <span class="string">&#x27;html&#x27;</span>, <span class="keyword">int</span> <span class="variable">$code</span> = <span class="number">200</span></span>): <span class="title">Response</span></span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       <span class="variable">$class</span> = <span class="literal">false</span> !== strpos(<span class="variable">$type</span>, <span class="string">&#x27;\\&#x27;</span>) ? <span class="variable">$type</span> : <span class="string">&#x27;\\think\\response\\&#x27;</span> . ucfirst(strtolower(<span class="variable">$type</span>));</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> Container::getInstance()-&gt;invokeClass(<span class="variable">$class</span>, [<span class="variable">$data</span>, <span class="variable">$code</span>]);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>这里是自动找response目录下的响应类，但我只想设置一个响应头来显示我的图片，文档翻遍了没找到方法，然后看了看目录下的Html类，那我们可以自己写一个自定义类来输出自己想要的响应格式</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Html Response</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Html</span> <span class="keyword">extends</span> <span class="title">Response</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 输出type</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$contentType</span> = <span class="string">&#x27;text/html&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">Cookie <span class="variable">$cookie</span>, <span class="variable">$data</span> = <span class="string">&#x27;&#x27;</span>, <span class="keyword">int</span> <span class="variable">$code</span> = <span class="number">200</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;init(<span class="variable">$data</span>, <span class="variable">$code</span>);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;cookie = <span class="variable">$cookie</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>于是我在response目录写了一个Jpeg类</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Html Response</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Jpeg</span> <span class="keyword">extends</span> <span class="title">Response</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 输出type</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$contentType</span> = <span class="string">&#x27;image/jpeg&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">Cookie <span class="variable">$cookie</span>, <span class="variable">$data</span> = <span class="string">&#x27;&#x27;</span>, <span class="keyword">int</span> <span class="variable">$code</span> = <span class="number">200</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;init(<span class="variable">$data</span>, <span class="variable">$code</span>);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;cookie = <span class="variable">$cookie</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以输出图片了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$response</span> = Response::create(<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;Jpeg&#x27;</span>);</span><br><span class="line"><span class="variable">$image</span>-&gt;blob(<span class="string">&#x27;JPEG&#x27;</span>);</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> HttpResponseException(<span class="variable">$response</span>);</span><br></pre></td></tr></table></figure><p>也许有办法不用这么麻烦，但是TP官方文档啥也没有写，一下子也找不到其他方法，导致我的header()函数都没用了，这里引用ThinkPHP论坛网友的一句话</p><blockquote><p>框架的定义就是在于更快速、便捷地开发应用<br>如果我使用了某款框架还是需要自己去注意条条款款，然后定义或修正许多形式上的规范，那还用框架干嘛呢<br>本末倒置，鸡蛋里面挑骨头</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
          <category> PHP </category>
          
          <category> ThinkPHP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>配置 frp 实现内网穿透（Linux）</title>
      <link href="2020/05/04/%E9%85%8D%E7%BD%AE%20frp%20%E5%AE%9E%E7%8E%B0%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%EF%BC%88Linux%EF%BC%89/"/>
      <url>2020/05/04/%E9%85%8D%E7%BD%AE%20frp%20%E5%AE%9E%E7%8E%B0%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%EF%BC%88Linux%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h1 id="配置-frp-实现内网穿透"><a href="#配置-frp-实现内网穿透" class="headerlink" title="配置 frp 实现内网穿透"></a>配置 frp 实现内网穿透</h1><p>frp 中文文档：<a href="https://github.com/fatedier/frp/blob/master/README_zh.md">https://github.com/fatedier/frp/blob/master/README_zh.md</a></p><p>一、frp 的作用</p><p>    利用处于内网或防火墙后的机器，对外网环境提供 http 或 https 服务。</p><p>    对于 http, https 服务支持基于域名的虚拟主机，支持自定义域名绑定，使多个域名可以共用一个80端口。</p><p>    利用处于内网或防火墙后的机器，对外网环境提供 tcp 和 udp 服务，例如在家里通过 ssh 访问处于公司内网环境内的主机。</p><p>二、安装 frp</p><p>1. github 地址：<a href="https://github.com/fatedier/frp/releases">https://github.com/fatedier/frp/releases</a></p><p>   可以用 wget 下载，公网、内网服务器都下载一份。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">wget https:<span class="comment">//github.com/fatedier/frp/releases/download/v0.33.0/frp_0.33.0_linux_amd64.tar.gz</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2、解压 tar -zxvf frp_0.33.0_linux_amd64.tar.gz</p><p>3、进入解压目录 cd frp_0.33.0_linux_amd64，这里所有 frpc 开头的文件都是客户端文件，所以全部删了，我们服务器只需要 frps 开头的文件</p><p><img src="https://cdn.learnku.com/uploads/images/202006/05/34227/J0ivil0xrS.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/05/34227/J0ivil0xrS.png!large" srcset="data:image/png;base64,666" alt="目录"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">rm -rf ./frpc*</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>4、配置服务端（公网服务器）</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">vim ./frps.ini</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>注意配置文件不支持注释，请不要把汉字复制进去</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[common]</span><br><span class="line"></span><br><span class="line">bind_port = <span class="number">7000</span>           #与客户端绑定的进行通信的端口</span><br><span class="line"></span><br><span class="line">vhost_http_port = <span class="number">6081</span>     #访问客户端web服务自定义的端口号</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>保存然后启动服务./frps -c ./frps.ini，这是前台启动，后台启动命令为 nohup ./frps -c ./frps.ini &amp;</p><p>5、配置客户端（内网服务器），首先删掉 frps 开头文件文件,然后再进行配置，vim ./frpc.ini</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[common]</span><br><span class="line"></span><br><span class="line">server_addr = <span class="number">47.93</span><span class="number">.33</span><span class="number">.108</span>   #公网服务器ip</span><br><span class="line"></span><br><span class="line">server_port = <span class="number">7000</span>            #与服务端bind_port一致</span><br><span class="line"></span><br><span class="line">[web]</span><br><span class="line"></span><br><span class="line">type = http         #访问协议</span><br><span class="line"></span><br><span class="line">local_port = <span class="number">80</span>   #内网web服务的端口号</span><br><span class="line"></span><br><span class="line">custom_domains = www.mczhangyi.top   #所绑定的公网服务器域名，一级、二级域名都可以</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>保存然后执行</p><p>Linux 的 Base 命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">.&#x2F;frpc -c .&#x2F;frpc.ini</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>windows 的 PowerShell 命令是</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">.&#x2F;frpc.exe -c .&#x2F;frpc.ini</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>6、访问方式</p><p>（1）外网 ssh 访问内网服务器（直接使用配置里面数据演示）</p><p>47.93.33.108 port:6000</p><p>47.93.33.108 port:22</p><p><a href="http://www.mczhangyi.top/">www.mczhangyi.top</a> port:6000</p><p><a href="http://www.mczhangyi.top/">www.mczhangyi.top</a> port:22</p><p>（2）自定义绑定域名访问内网 web 服务（注意服务端绑定的是哪个端口记得加上）</p><p><a href="http://www.mczhangyi.top:6081/">www.mczhangyi.top:6081</a></p><p>三、结尾</p><p>1.客户端连接服务端提示访问被拒绝，则需要服务端开放防火墙端口（学习的话全开就行了，生产环境除外）。</p><p>2.frps dashboard 通过浏览器查看 frp 的状态以及代理统计信息展示。</p><p>注：Dashboard 尚未针对大量的 proxy 数据展示做优化，如果出现 Dashboard 访问较慢的情况，请不要启用此功能。</p><p>需要在 服务端的 frps.ini 中指定 dashboard 服务使用的端口，即可开启此功能：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[common]</span><br><span class="line"></span><br><span class="line">dashboard_port = <span class="number">7500</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="dashboard-用户名密码，默认都为-admin"><a href="#dashboard-用户名密码，默认都为-admin" class="headerlink" title="dashboard 用户名密码，默认都为 admin"></a>dashboard 用户名密码，默认都为 admin</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">dashboard_user = admin</span><br><span class="line"></span><br><span class="line">dashboard_pwd = admin</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>打开浏览器通过 http://[server_addr]:7500 访问 dashboard 界面，用户名密码默认为 admin。</p><p>3.其他功能请阅读 frp 中文文档：<a href="https://github.com/fatedier/frp/blob/master/README_zh.md">https://github.com/fatedier/frp/blob/master/README_zh.md</a></p>]]></content>
      
      
      <categories>
          
          <category> 内网穿透 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>apache 经常无法访问目录列表,显示 403 forbidden</title>
      <link href="2020/05/04/apache%20%E7%BB%8F%E5%B8%B8%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AE%E7%9B%AE%E5%BD%95%E5%88%97%E8%A1%A8,%E6%98%BE%E7%A4%BA%20403%20forbidden/"/>
      <url>2020/05/04/apache%20%E7%BB%8F%E5%B8%B8%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AE%E7%9B%AE%E5%BD%95%E5%88%97%E8%A1%A8,%E6%98%BE%E7%A4%BA%20403%20forbidden/</url>
      
        <content type="html"><![CDATA[<h1 id="apache经常无法访问目录列表-显示403-forbidden"><a href="#apache经常无法访问目录列表-显示403-forbidden" class="headerlink" title="apache经常无法访问目录列表,显示403 forbidden"></a>apache经常无法访问目录列表,显示403 forbidden</h1><p>开发学习时，每次重置apache时，老是报错：Forbidden You don’t have permission to access / on this server.，真是气死人</p><p><img src="https://cdn.learnku.com/uploads/images/202005/26/34227/UNWKW2CuRF.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202005/26/34227/UNWKW2CuRF.png!large" srcset="data:image/png;base64,666" alt="在这里插入图片描述"></p><p>我统计一下我碰到过的问题和解决办法</p><p>首先Linux的话网站目录权限直接改成755</p><p>解决办法1：</p><p>　　　　找到 /usr/local/apache/conf/httpd.conf</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Include conf/extra/httpd-vhosts.conf</span><br></pre></td></tr></table></figure><p>由于vhosts刚装时没有配置过，将其注释了掉，然后重启apache就能访问了</p><p>解决办法2：</p><p>　　　　把index.php和|.php(PHP探针,没有的话就不用动)文件名修改掉</p><p><img src="https://cdn.learnku.com/uploads/images/202005/26/34227/E7f3tUurpd.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202005/26/34227/E7f3tUurpd.png!large" srcset="data:image/png;base64,666" alt="在这里插入图片描述"><br>解决办法3：<br>    这个困扰了我很久，改了apache配置文件也没用后来发现是根目录.htaccess文件被我设置成-indexs，改成+indexs就行了<br>    <img src="https://cdn.learnku.com/uploads/images/202005/26/34227/vHz8RnYmuy.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202005/26/34227/vHz8RnYmuy.png!large" srcset="data:image/png;base64,666" alt=".htaccess"></p>]]></content>
      
      
      <categories>
          
          <category> 服务器 </category>
          
          <category> Web </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>PHP 去除 bom 头，JSON_decode () 返回 NULL，PHP 无法对字符串做处理</title>
      <link href="2020/05/04/PHP%20%E5%8E%BB%E9%99%A4%20bom%20%E5%A4%B4%EF%BC%8CJSON_decode%20()%20%E8%BF%94%E5%9B%9E%20NULL%EF%BC%8CPHP%20%E6%97%A0%E6%B3%95%E5%AF%B9%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%81%9A%E5%A4%84%E7%90%86/"/>
      <url>2020/05/04/PHP%20%E5%8E%BB%E9%99%A4%20bom%20%E5%A4%B4%EF%BC%8CJSON_decode%20()%20%E8%BF%94%E5%9B%9E%20NULL%EF%BC%8CPHP%20%E6%97%A0%E6%B3%95%E5%AF%B9%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%81%9A%E5%A4%84%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p>今天碰到了一个json字符串无法处理，这是因为这个字符串带有bom头</p><p><img src="https://cdn.learnku.com/uploads/images/202005/26/34227/F6FbsXG36o.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202005/26/34227/F6FbsXG36o.png!large" srcset="data:image/png;base64,666" alt="在这里插入图片描述"><br>去除bom头代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$rs</span> = trim(<span class="variable">$rs</span>, <span class="string">&quot;\xEF\xBB\xBF&quot;</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
          <category> PHP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Larvel 操作 MongoDB（对内嵌数组增删改）</title>
      <link href="2020/05/04/Larvel%20%E6%93%8D%E4%BD%9C%20MongoDB%EF%BC%88%E5%AF%B9%E5%86%85%E5%B5%8C%E6%95%B0%E7%BB%84%E5%A2%9E%E5%88%A0%E6%94%B9%EF%BC%89/"/>
      <url>2020/05/04/Larvel%20%E6%93%8D%E4%BD%9C%20MongoDB%EF%BC%88%E5%AF%B9%E5%86%85%E5%B5%8C%E6%95%B0%E7%BB%84%E5%A2%9E%E5%88%A0%E6%94%B9%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h1 id="Larvel操作MongoDB（对内嵌数组增删改）"><a href="#Larvel操作MongoDB（对内嵌数组增删改）" class="headerlink" title="Larvel操作MongoDB（对内嵌数组增删改）"></a>Larvel操作MongoDB（对内嵌数组增删改）</h1><p>PHP的<a href="https://www.php.cn/manual/view/4.html">MongoDB驱动中文文档</a></p><p>PHP的<a href="https://www.php.net/manual/zh/book.mongodb.php">MongoDB驱动官方文档</a></p><p>有些细节都没写全，如想学习请阅读官方文档！</p><h3 id="普通的增删改查与mysql驱动操作一样"><a href="#普通的增删改查与mysql驱动操作一样" class="headerlink" title="普通的增删改查与mysql驱动操作一样"></a>普通的增删改查与mysql驱动操作一样</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">增</span><br><span class="line"></span><br><span class="line"><span class="variable">$rs</span> = DB::collection(<span class="string">&#x27;集合名字&#x27;</span>)-&gt;insertGetId(<span class="variable">$param</span>);</span><br><span class="line"><span class="variable">$rs</span> = DB::collection(<span class="string">&#x27;集合名字&#x27;</span>)-&gt;insert(<span class="variable">$param</span>);</span><br><span class="line">删</span><br><span class="line"></span><br><span class="line"><span class="variable">$rs</span> = DB::collection(<span class="string">&#x27;集合名字&#x27;</span>)-&gt;where([<span class="string">&quot;_id&quot;</span>=&gt;<span class="number">1</span>])-&gt;delete();</span><br><span class="line">改</span><br><span class="line"></span><br><span class="line"><span class="variable">$rs</span> = DB::collection(<span class="string">&#x27;集合名字&#x27;</span>)-&gt;where([<span class="string">&quot;_id&quot;</span>=&gt;<span class="number">1</span>])-&gt;update([<span class="string">&#x27;name&#x27;</span>=&lt;<span class="string">&#x27;遗失的美好&#x27;</span>]);</span><br><span class="line">查</span><br><span class="line"><span class="variable">$result</span> = DB::collection(<span class="string">&#x27;集合名字&#x27;</span>)-&gt;where([<span class="string">&quot;_id&quot;</span>=&gt;<span class="number">1</span>])-&gt;get();</span><br><span class="line"><span class="comment">// 分页函数</span></span><br><span class="line"><span class="variable">$results</span> = DB::collection(<span class="string">&#x27;集合名字&#x27;</span>)-&gt;paginate(<span class="number">10</span>);</span><br><span class="line"><span class="comment">// 这样也能做到分页 还有排序 </span></span><br><span class="line">orderBy()　　排序函数，</span><br><span class="line">skip()　　　 跳过几条 </span><br><span class="line">limit()　　  限制取出几条</span><br><span class="line"><span class="variable">$rs</span> = DB::collection(<span class="string">&#x27;集合名字&#x27;</span>)-&gt;orderBy(<span class="string">&#x27;age&#x27;</span>,<span class="string">&#x27;asc&#x27;</span>)-&gt;skip(<span class="number">10</span>))-&gt;limit(<span class="number">10</span>)-&gt;get();</span><br></pre></td></tr></table></figure><h3 id="对内嵌数组进行增删改，首先要知道："><a href="#对内嵌数组进行增删改，首先要知道：" class="headerlink" title="对内嵌数组进行增删改，首先要知道："></a>对内嵌数组进行增删改，首先要知道：</h3><p><a href="https://www.runoob.com/mongodb/mongodb-operators.html">MongoDB操作符</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">增</span><br><span class="line"></span><br><span class="line"><span class="comment">// 插入数组 $addToSet 插入时如果已经存在相同的则不插入    </span></span><br><span class="line"><span class="variable">$rs</span> = DB::collection(<span class="string">&#x27;user_files_folder&#x27;</span>)-&gt;update([<span class="string">&#x27;$addToSet&#x27;</span>=&gt;[<span class="string">&#x27;child&#x27;</span>=&gt;[<span class="string">&#x27;name&#x27;</span>=&gt;<span class="string">&#x27;二傻子&#x27;</span>]])</span><br><span class="line"></span><br><span class="line"><span class="comment">// 插入数组 $push 插入时如果已经存在相同的仍然插入</span></span><br><span class="line"><span class="variable">$rs</span> = DB::collection(<span class="string">&#x27;user_files_folder&#x27;</span>)-&gt;update([<span class="string">&#x27;$push&#x27;</span>=&gt;[<span class="string">&#x27;child&#x27;</span>=&gt;[<span class="string">&#x27;name&#x27;</span>=&gt;<span class="string">&#x27;二傻子&#x27;</span>]])</span><br><span class="line"></span><br><span class="line">删</span><br><span class="line"></span><br><span class="line"><span class="variable">$rs</span> = DB::collection(<span class="string">&#x27;user_files_folder&#x27;</span>)-&gt;update([<span class="string">&#x27;$pull&#x27;</span>=&gt;[<span class="string">&#x27;child&#x27;</span>=&gt;[<span class="string">&#x27;name&#x27;</span>=&gt;<span class="string">&#x27;二傻子&#x27;</span>]])</span><br><span class="line">改</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注意，这where条件如果需要多重结构则可以用.连接</span></span><br><span class="line"><span class="variable">$set</span>是修改操作符，对应修改对象（数组）</span><br><span class="line">修改对象如果需要多重结构也可以用.连接，这里的$符号代表对应的键（因为这里的数据结构是一个数组，$代表对应的序号，也可以写死成 <span class="number">0</span><span class="number">-9</span>之类的数字）</span><br><span class="line"></span><br><span class="line">DB::collection(<span class="string">&#x27;stock&#x27;</span>)-&gt;where([<span class="string">&#x27;info.id&#x27;</span>=&gt;<span class="string">&quot;118b110212&quot;</span>])-&gt;update([</span><br><span class="line">    <span class="variable">$set</span><span class="string">&#x27;=&gt;[</span></span><br><span class="line"><span class="string">        &#x27;</span>info.$.id<span class="string">&#x27;=&gt;&quot;118b110jkjkjk&quot;</span></span><br><span class="line"><span class="string">     ]</span></span><br><span class="line"><span class="string">]);</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
          <category> PHP </category>
          
          <category> 数据库 </category>
          
          <category> MongoDB </category>
          
          <category> Laravel </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>git设置下载代理</title>
      <link href="2020/04/04/git%E8%AE%BE%E7%BD%AE%E4%B8%8B%E8%BD%BD%E4%BB%A3%E7%90%86/"/>
      <url>2020/04/04/git%E8%AE%BE%E7%BD%AE%E4%B8%8B%E8%BD%BD%E4%BB%A3%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p>因为某些原因，我们下载git clone GitHub特别慢</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git clone https:<span class="comment">//github.com/zoujingli/ThinkAdmin.git</span></span><br><span class="line">Cloning into &#x27;ThinkAdmin&#x27;...</span><br><span class="line">remote: Enumerating objects: <span class="number">663</span>, done.</span><br><span class="line">remote: Counting objects: <span class="number">100</span>% (<span class="number">663</span>/<span class="number">663</span>), done.</span><br><span class="line">remote: Compressing objects: <span class="number">100</span>% (<span class="number">483</span>/<span class="number">483</span>), done.</span><br><span class="line">Receiving objects:   <span class="number">1</span>% (<span class="number">389</span>/<span class="number">32521</span>), <span class="number">68.01</span> KiB | <span class="number">6.00</span> KiB/s</span><br></pre></td></tr></table></figure><p>这时候就需要一个代理，不然下载要等到明年，首先你要有一台代理服务器（看看网上有没有好心人共享），然后一般windows代理的端口是1080，看你软件自己的设置，这里我用的是V2XXX</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">inbounds&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;tag&quot;</span>: <span class="string">&quot;proxy&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;port&quot;</span>: <span class="number">1080</span>,</span><br><span class="line">      <span class="attr">&quot;listen&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;protocol&quot;</span>: <span class="string">&quot;socks&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;sniffing&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;enabled&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">&quot;destOverride&quot;</span>: [</span><br><span class="line">          <span class="string">&quot;http&quot;</span>,</span><br><span class="line">          <span class="string">&quot;tls&quot;</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br></pre></td></tr></table></figure><p>然后命令行输入，注意git没有https代理，http包含了https，网上的教程都有误，而且地址不能加单引号</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.proxy socks5:<span class="comment">//127.0.0.1:1080</span></span><br></pre></td></tr></table></figure><p>查看所有代理</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global --<span class="built_in">list</span></span><br></pre></td></tr></table></figure><p>取消代理</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global --unset http.proxy</span><br></pre></td></tr></table></figure><p>查看成果，这速度杠杠的</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Cloning into &#x27;ThinkAdmin&#x27;...</span><br><span class="line">remote: Enumerating objects: <span class="number">663</span>, done.</span><br><span class="line">remote: Counting objects: <span class="number">100</span>% (<span class="number">663</span>/<span class="number">663</span>), done.</span><br><span class="line">remote: Compressing objects: <span class="number">100</span>% (<span class="number">483</span>/<span class="number">483</span>), done.</span><br><span class="line">Receiving objects:  <span class="number">14</span>% (<span class="number">4553</span>/<span class="number">32521</span>), <span class="number">4.90</span> MiB | <span class="number">990.00</span> KiB/s</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> git </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>MySQL int类型长度的意义是什么</title>
      <link href="2020/04/04/MySQL%20int%E7%B1%BB%E5%9E%8B%E9%95%BF%E5%BA%A6%E7%9A%84%E6%84%8F%E4%B9%89%E6%98%AF%E4%BB%80%E4%B9%88/"/>
      <url>2020/04/04/MySQL%20int%E7%B1%BB%E5%9E%8B%E9%95%BF%E5%BA%A6%E7%9A%84%E6%84%8F%E4%B9%89%E6%98%AF%E4%BB%80%E4%B9%88/</url>
      
        <content type="html"><![CDATA[<ul><li>当我们设置int类型时，可以设置int(11)，给int一个长度，一直以来都是认为mysql的int储存的值的长度与设置的int长度有关，如int(3)表示只能储存3位数字int(11)能存储11位数字。其实这根本就是大错特错。int永远只占4个字节，范围也不变（无符号除外）</li><li>其实int(1)和int(255)的范围是不变的，完全一模一样，那么长度的意义是什么呢，查了半天资料，最终想明白了，这个长度需要配合zerofill来使用，当设置了zerofill属性时，比如int(3)，那么储存一个1时，会自动填充到3位：001 ，这个在某些使用场景是有用的，int(5)就是: 00001</li><li>那么其他类型呢？tinyint跟int是一样的，而char、varchar等字符类型则确确实实表示字节大小范围，在UTF-8编码下，char(1)则表示只能存1个字符（汉字），char(5)则表示只能存5个字符（汉字）</li></ul><p>官方手册：<a href="https://dev.mysql.com/doc/refman/8.0/en/numeric-type-attributes.html" title="点我">点我前往</a><br>以上</p>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
          <category> MySQL </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>open_basedir() restrictijon in effect. FIle()</title>
      <link href="2020/04/04/open_basedir()%20restrictijon%20in%20effect.%20FIle()%20/"/>
      <url>2020/04/04/open_basedir()%20restrictijon%20in%20effect.%20FIle()%20/</url>
      
        <content type="html"><![CDATA[<ul><li><p>宝塔里Laravel或thinkphp框架报Warning: require(): open_basedir() restrictijon in effect. FIle() 错误</p></li><li><p>open_basedir是PHP限制访问文件夹的配置参数，宝塔里自动配置了.user.ini，但是目录限制到了public，我们需要将其改到项目根目录<br>打开 项目根目录/public/.user.ini文件</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open_basedir=/www/wwwroot/zmxyphp/<span class="keyword">public</span>/:/tmp/:/proc/</span><br></pre></td></tr></table></figure></li><li><p>把public删除</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open_basedir=/www/wwwroot/zmxyphp/:/tmp/:/proc/</span><br></pre></td></tr></table></figure></li><li><p>重启PHP，OK！</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 服务器 </category>
          
          <category> Linux </category>
          
          <category> 宝塔 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>PHP扫描图片转点阵 二维码转点阵</title>
      <link href="2020/04/04/PHP%E6%89%AB%E6%8F%8F%E5%9B%BE%E7%89%87%E8%BD%AC%E7%82%B9%E9%98%B5%20%E4%BA%8C%E7%BB%B4%E7%A0%81%E8%BD%AC%E7%82%B9%E9%98%B5/"/>
      <url>2020/04/04/PHP%E6%89%AB%E6%8F%8F%E5%9B%BE%E7%89%87%E8%BD%AC%E7%82%B9%E9%98%B5%20%E4%BA%8C%E7%BB%B4%E7%A0%81%E8%BD%AC%E7%82%B9%E9%98%B5/</url>
      
        <content type="html"><![CDATA[<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 图片转点阵（黑白）</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> string $imgPath</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">imgToLattice</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$imgPath</span></span>): <span class="title">array</span></span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       <span class="variable">$size</span> = getimagesize(<span class="variable">$imgPath</span>);<span class="comment">// 得到图片的信息</span></span><br><span class="line">       <span class="variable">$im</span> = imagecreatefrompng(<span class="variable">$imgPath</span>);<span class="comment">// 創建一張圖片</span></span><br><span class="line">       <span class="comment">// 储存二进制数组</span></span><br><span class="line">       <span class="variable">$lattice</span> = [];</span><br><span class="line">       <span class="variable">$white</span> = [</span><br><span class="line">           <span class="string">&#x27;red&#x27;</span> =&gt; <span class="number">255</span>,</span><br><span class="line">           <span class="string">&#x27;green&#x27;</span> =&gt; <span class="number">255</span>,</span><br><span class="line">           <span class="string">&#x27;blue&#x27;</span> =&gt; <span class="number">255</span>,</span><br><span class="line">           <span class="string">&#x27;alpha&#x27;</span> =&gt; <span class="number">0</span>,</span><br><span class="line">       ];</span><br><span class="line">       <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$size</span>[<span class="number">1</span>]; ++ <span class="variable">$i</span>) &#123;</span><br><span class="line">           <span class="variable">$lattice</span>[<span class="variable">$i</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">           <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; <span class="variable">$j</span> &lt; <span class="variable">$size</span>[<span class="number">0</span>]; ++<span class="variable">$j</span>) &#123;</span><br><span class="line">               <span class="variable">$rgb</span> = imagecolorat(<span class="variable">$im</span>, <span class="variable">$j</span>, <span class="variable">$i</span>);          <span class="comment">//取得某像素的颜色索引值</span></span><br><span class="line">               <span class="variable">$rgbArr</span> = imagecolorsforindex(<span class="variable">$im</span>, <span class="variable">$rgb</span>);</span><br><span class="line">               <span class="keyword">if</span> (<span class="variable">$white</span> === <span class="variable">$rgbArr</span>)&#123;</span><br><span class="line">                   <span class="variable">$lattice</span>[<span class="variable">$i</span>] .= <span class="number">0</span>;</span><br><span class="line">               &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                   <span class="variable">$lattice</span>[<span class="variable">$i</span>] .= <span class="number">1</span>;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> [<span class="variable">$lattice</span>, <span class="variable">$size</span>];</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>注解：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$rgbArr</span> = imagecolorsforindex(<span class="variable">$im</span>, <span class="variable">$rgb</span>);</span><br></pre></td></tr></table></figure><p>这里返回一个RGB数组，跟$white数组一样，我因为二维码只有黑白，所以这里只做了黑白判断，黑就是1，白就是0，如果你的图片支持三种级以上，这里可以做判断，拼接其他数字</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$white</span> === <span class="variable">$rgbArr</span>)&#123;</span><br><span class="line"><span class="variable">$lattice</span>[<span class="variable">$i</span>] .= <span class="number">0</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$lattice</span>[<span class="variable">$i</span>] .= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>打印出来效果：<br><img src="https://cdn.learnku.com/uploads/images/202008/09/34227/90cS9FkSwe.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202008/09/34227/90cS9FkSwe.png!large" srcset="data:image/png;base64,666"><br>转成HTML：<br><img src="https://cdn.learnku.com/uploads/images/202008/09/34227/TR2UL2b3ow.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202008/09/34227/TR2UL2b3ow.png!large" srcset="data:image/png;base64,666"><br>参考代码：<br>$this-&gt;image就上面PHP生成的数据，替换成自己的就行了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Lattice</span>\<span class="title">LatticePck</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 点阵输出类</span></span><br><span class="line"><span class="comment"> * Class LatticeOutput</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LatticeOutput</span> <span class="keyword">extends</span> <span class="title">Lattice</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 二进制输出方法 HTML 把当前视图输出</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getBinaryOutHtml</span>(<span class="params"></span>): <span class="title">string</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$str</span>=<span class="string">&quot;&lt;html&gt;&lt;body&gt;&lt;div class=&#x27;k&#x27;&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;image <span class="keyword">as</span> <span class="variable">$item</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$str</span> .= <span class="keyword">$this</span>-&gt;getBinaryOutRow(<span class="variable">$item</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$str</span> .= <span class="string">&quot;&lt;/div&gt;&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$str</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 二进制输出方法 HTML 输出一行视图</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $string</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getBinaryOutRow</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$string</span></span>): <span class="title">string</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$strLen</span> = mb_strlen(<span class="variable">$string</span>);</span><br><span class="line">        <span class="variable">$html</span> = [</span><br><span class="line">            <span class="string">&quot;&lt;div&gt;&lt;/div&gt;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;&lt;div class=&#x27;h&#x27;&gt;&lt;/div&gt;&quot;</span>,</span><br><span class="line">        ];</span><br><span class="line">        <span class="variable">$str</span>=<span class="string">&quot;&lt;div class=&#x27;g&#x27;&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="variable">$strLen</span>;<span class="variable">$i</span>++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$str</span> .= <span class="variable">$html</span>[<span class="variable">$string</span>[<span class="variable">$i</span>]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$str</span>.=<span class="string">&quot;&lt;/div&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$str</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getHtml</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;!DOCTYPE\&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;html xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;</span></span><br><span class="line"><span class="string">        &lt;meta name=\&quot;viewport\&quot; content=\&quot;width=device-width,user-scalabl</span></span><br><span class="line"><span class="string">        e=no\&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;title&gt;测试&lt;/title&gt;</span></span><br><span class="line"><span class="string">        &lt;style&gt;</span></span><br><span class="line"><span class="string">            .k &#123;</span></span><br><span class="line"><span class="string">                margin: 0px;</span></span><br><span class="line"><span class="string">                padding: 0px;</span></span><br><span class="line"><span class="string">                width: 296px;</span></span><br><span class="line"><span class="string">                height:128px;</span></span><br><span class="line"><span class="string">                background-color: #F8F8F8;</span></span><br><span class="line"><span class="string">                float: none;</span></span><br><span class="line"><span class="string">                border: 2px solid #999999;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            .g &#123;</span></span><br><span class="line"><span class="string">                margin: 0px;</span></span><br><span class="line"><span class="string">                padding: 0px;</span></span><br><span class="line"><span class="string">                width: 100%;</span></span><br><span class="line"><span class="string">                float: none;</span></span><br><span class="line"><span class="string">                height: 1px;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            .h&#123;</span></span><br><span class="line"><span class="string">                background-color: #000000;</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            .g div&#123;</span></span><br><span class="line"><span class="string">                margin: 0px;</span></span><br><span class="line"><span class="string">                padding: 0px;</span></span><br><span class="line"><span class="string">                width: 1px;</span></span><br><span class="line"><span class="string">                float: left;</span></span><br><span class="line"><span class="string">                height: 1px;</span></span><br><span class="line"><span class="string">                position: relative;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            .g div.h&#123;</span></span><br><span class="line"><span class="string">                background-color: #000000;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        &lt;/style&gt;</span></span><br><span class="line"><span class="string">        &lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFoot</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$lattice</span> = <span class="keyword">new</span> LatticeOutput();</span><br><span class="line"></span><br><span class="line"><span class="variable">$lattice</span>-&gt;getHtml();</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$lattice</span>-&gt;getBinaryOutHtml();</span><br><span class="line"><span class="variable">$lattice</span>-&gt;getFoot();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
          <category> PHP </category>
          
          <category> 图片 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>PHP设计模式之观察者模式</title>
      <link href="2020/04/04/PHP%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
      <url>2020/04/04/PHP%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h4 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h4><p>假设项目经理让我们写了一个登陆接口，咔咔擦擦写完了</p><ul><li>第二天让我们加入统计登陆次数，然后在后面加代码</li><li>第三天让我们判断登陆地区，又在后面加代码</li><li>第四天让我们在用户登陆后推送活动，再再后面加代码</li><li>第N天，这个接口已经杂乱到没人想维护了</li></ul><p>我们需要让项目保持高内聚低耦合，就可以用到观察者模式（也不是非要，看需求）</p><h4 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h4><p>观察者，观察者，首先要有个被人观察的角色，这是唯一的，然后会有无数个观察者去看她，可以说是一群人在围观一个人，既然有无数个观众，那总得有个东西记录有哪些观察者，那就应该有一个类似于数组一样来储存所有观察者，总结就是一个被观察者，无数个观察者，再有一个容器记录</p><h4 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h4><ul><li>接口示例<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 主题接口</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Subject</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">register</span>(<span class="params">Observer <span class="variable">$observer</span></span>)</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">notify</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 观察者接口</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Observer</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">watch</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>Subject就是被观察者，Observer就是观众，也就是观察者</li></ul><h3 id="被观察者"><a href="#被观察者" class="headerlink" title="被观察者"></a>被观察者</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 被观察者</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Action</span> <span class="keyword">implements</span> <span class="title">Subject</span></span>&#123;</span><br><span class="line">     <span class="keyword">public</span> <span class="variable">$_observers</span>=<span class="keyword">array</span>();</span><br><span class="line">     <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">register</span>(<span class="params">Observer <span class="variable">$observer</span></span>)</span>&#123;</span><br><span class="line">         <span class="keyword">$this</span>-&gt;_observers[]=<span class="variable">$observer</span>;</span><br><span class="line">     &#125;</span><br><span class="line"> </span><br><span class="line">     <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">notify</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">         <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;_observers <span class="keyword">as</span> <span class="variable">$observer</span>) &#123;</span><br><span class="line">             <span class="variable">$observer</span>-&gt;watch();</span><br><span class="line">         &#125;</span><br><span class="line"> </span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>Action实现了被观察者接口，他现在就是被观察者，再定义一个$_observers数组，他就是记录观众的容器了。<br>首先实现register方法，用它传入一个观察者，然后塞到数组里，再实现notify()方法，它会遍历容器数组，执行每个观察者的watch()方法。</p><h4 id="观察者"><a href="#观察者" class="headerlink" title="观察者"></a>观察者</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 观察者</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">implements</span> <span class="title">Observer</span></span>&#123;</span><br><span class="line">     <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">watch</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">         <span class="keyword">echo</span> <span class="string">&quot;Cat watches TV&lt;hr/&gt;&quot;</span>;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">implements</span> <span class="title">Observer</span></span>&#123;</span><br><span class="line">     <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">watch</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">         <span class="keyword">echo</span> <span class="string">&quot;Dog watches TV&lt;hr/&gt;&quot;</span>;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">People</span> <span class="keyword">implements</span> <span class="title">Observer</span></span>&#123;</span><br><span class="line">     <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">watch</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">         <span class="keyword">echo</span> <span class="string">&quot;People watches TV&lt;hr/&gt;&quot;</span>;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p> 这里定义了三个观察者，全都实现了Observer接口，前面的Subject会循环调用每个观察者的watch()方法，所以我们需要实现每个观察者的watch()方法。</p><h4 id="调用"><a href="#调用" class="headerlink" title="调用"></a>调用</h4> <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 应用实例</span></span><br><span class="line"><span class="variable">$action</span>=<span class="keyword">new</span> Action();</span><br><span class="line"><span class="variable">$action</span>-&gt;register(<span class="keyword">new</span> Cat());</span><br><span class="line"><span class="variable">$action</span>-&gt;register(<span class="keyword">new</span> People());</span><br><span class="line"><span class="variable">$action</span>-&gt;register(<span class="keyword">new</span> Dog());</span><br><span class="line"><span class="variable">$action</span>-&gt;notify();</span><br></pre></td></tr></table></figure><p>首先new被观察者对象，执行它的register()方法，把每个观察者都放入容器数组，最后执行notify()方法，通知所有观察者执行自己的方法。</p><h4 id="PHP原生自带的观察者模式"><a href="#PHP原生自带的观察者模式" class="headerlink" title="PHP原生自带的观察者模式"></a>PHP原生自带的观察者模式</h4><p>PHP有自带的观察者模式</p><ul><li>splsubject接口 - 被观察者</li><li>Observer接口 - 观察者</li><li>SplObjectStorage对象 - 容器</li></ul><p>首先我们有一个用户登录类</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">user</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;登录完毕&#x27;</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>让他实现splsubject接口成为被观察者。</p><ul><li>首先在构造函数里，让他new SplObjectStorag()对象并赋值到属性上方便后面调用</li><li>实现attach()方法，用来注册观察者</li><li>实现detach()方法，用来删除观察者</li><li>实现notify()方法，用来遍历容器，调用每个观察者的update方法(必须是update)</li><li>rewind方法是容器指针重置到最开始，valid方法检测容器是否遍历完成并返回布尔，current方法是获取当前的观察者，next方法是将指针后移一位</li><li>修改login()方法，在里面调用notify()来通知观察者事件完成了<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">user</span> <span class="keyword">implements</span> <span class="title">splsubject</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$observer</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;observer = <span class="keyword">new</span> <span class="built_in">SplObjectStorage</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;notify();</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;登录完毕&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">attach</span>(<span class="params"><span class="built_in">SplObserver</span> <span class="variable">$observer</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;observer-&gt;attach(<span class="variable">$observer</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">detach</span>(<span class="params"><span class="built_in">SplObserver</span> <span class="variable">$observer</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;observer-&gt;detach(<span class="variable">$observer</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">notify</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;observer-&gt;rewind();</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">$this</span>-&gt;observer-&gt;valid())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$observer</span> = <span class="keyword">$this</span>-&gt;observer-&gt;current();</span><br><span class="line">            <span class="variable">$observer</span>-&gt;update(<span class="keyword">$this</span>);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;observer-&gt;next();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h4 id="观察者-1"><a href="#观察者-1" class="headerlink" title="观察者"></a>观察者</h4><p>每个观察者实现SplObserver接口，并实现update()方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cat</span> <span class="keyword">implements</span> <span class="title">SplObserver</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params"><span class="built_in">SplSubject</span> <span class="variable">$subject</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;小猫叫一下&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">dog</span> <span class="keyword">implements</span> <span class="title">SplObserver</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params"><span class="built_in">SplSubject</span> <span class="variable">$subject</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;小狗吼一声&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实时观察</span></span><br><span class="line"><span class="variable">$user</span> = <span class="keyword">new</span> user();</span><br><span class="line"><span class="variable">$user</span>-&gt;attach(<span class="keyword">new</span> cat());</span><br><span class="line"><span class="variable">$user</span>-&gt;attach(<span class="keyword">new</span> dog());</span><br><span class="line"><span class="variable">$user</span>-&gt;login();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
          <category> PHP </category>
          
          <category> 设计模式 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Vue router 使用 History 模式导致页面请求 404</title>
      <link href="2020/04/04/Vue%20router%20%E4%BD%BF%E7%94%A8%20History%20%E6%A8%A1%E5%BC%8F%E5%AF%BC%E8%87%B4%E9%A1%B5%E9%9D%A2%E8%AF%B7%E6%B1%82%20404/"/>
      <url>2020/04/04/Vue%20router%20%E4%BD%BF%E7%94%A8%20History%20%E6%A8%A1%E5%BC%8F%E5%AF%BC%E8%87%B4%E9%A1%B5%E9%9D%A2%E8%AF%B7%E6%B1%82%20404/</url>
      
        <content type="html"><![CDATA[<p><code>vue-router</code> 默认 hash 模式 —— 使用 URL 的 hash 来模拟一个完整的 URL，于是当 URL 改变时，页面不会重新加载。</p><p>如果不想要很丑的 hash，我们可以用路由的 <strong>history 模式</strong>，这种模式充分利用 <code>history.pushState</code> API 来完成 URL 跳转而无须重新加载页面。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">  mode: <span class="string">&#x27;history&#x27;</span>,</span><br><span class="line">  routes: [...]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>当你使用 history 模式时，URL 就像正常的 url，例如 <a href="http://yoursite.com/user/id%EF%BC%8C%E4%B9%9F%E5%A5%BD%E7%9C%8B%EF%BC%81">http://yoursite.com/user/id，也好看！</a></p><p>不过这种模式要玩好，还需要后台配置支持。因为我们的应用是个单页客户端应用，如果后台没有正确的配置，当用户在浏览器直接访问 <a href="http://oursite.com/user/id">http://oursite.com/user/id</a> 就会返回 404，这就不好看了。</p><p>所以呢，你要在服务端增加一个覆盖所有情况的候选资源：如果 URL 匹配不到任何静态资源，则应该返回同一个 index.html 页面，这个页面就是你 app 依赖的页面。</p><h1 id="后端配置例子"><a href="#后端配置例子" class="headerlink" title="后端配置例子"></a>后端配置例子</h1><p><strong>注意</strong>：下列示例假设你在根目录服务这个应用。如果想部署到一个子目录，你需要使用 <a href="https://cli.vuejs.org/zh/config/#publicpath">Vue CLI 的 <code>publicPath</code> 选项</a> 和相关的 <a href="https://router.vuejs.org/zh/api/#base">router <code>base</code> property</a>。你还需要把下列示例中的根目录调整成为子目录 (例如用 <code>RewriteBase /name-of-your-subfolder/</code> 替换掉 <code>RewriteBase /</code>)。</p><h4 id="Apache"><a href="#Apache" class="headerlink" title="Apache"></a>Apache</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;IfModule mod_rewrite.c&gt;</span><br><span class="line">  RewriteEngine On</span><br><span class="line">  RewriteBase &#x2F;</span><br><span class="line">  RewriteRule ^index\.html$ - [L]</span><br><span class="line">  RewriteCond %&#123;REQUEST_FILENAME&#125; !-f</span><br><span class="line">  RewriteCond %&#123;REQUEST_FILENAME&#125; !-d</span><br><span class="line">  RewriteRule .&#x2F;index.html [L]</span><br><span class="line">&lt;&#x2F;IfModule&gt;</span><br></pre></td></tr></table></figure><p>除了 mod_rewrite，你也可以使用 FallbackResource。</p><h4 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location &#x2F; &#123;</span><br><span class="line">  try_files $uri $uri&#x2F; &#x2F;index.html;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="原生-Node-js"><a href="#原生-Node-js" class="headerlink" title="原生 Node.js"></a>原生 Node.js</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">const http &#x3D; require(&#39;http&#39;)</span><br><span class="line">const fs &#x3D; require(&#39;fs&#39;)</span><br><span class="line">const httpPort &#x3D; 80</span><br><span class="line"></span><br><span class="line">http.createServer((req, res) &#x3D;&gt; &#123;</span><br><span class="line">  fs.readFile(&#39;index.htm&#39;, &#39;utf-8&#39;, (err, content) &#x3D;&gt; &#123;</span><br><span class="line">    if (err) &#123;</span><br><span class="line">      console.log(&#39;We cannot open &quot;index.htm&quot; file.&#39;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    res.writeHead(200, &#123;</span><br><span class="line">      &#39;Content-Type&#39;: &#39;text&#x2F;html; charset&#x3D;utf-8&#39;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    res.end(content)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;).listen(httpPort, () &#x3D;&gt; &#123;</span><br><span class="line">  console.log(&#39;Server listening on: http:&#x2F;&#x2F;localhost:%s&#39;, httpPort)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="基于-Node-js-的-Express"><a href="#基于-Node-js-的-Express" class="headerlink" title="#基于 Node.js 的 Express"></a><a href="https://router.vuejs.org/zh/guide/essentials/history-mode.html#%E5%9F%BA%E4%BA%8E-node-js-%E7%9A%84-express">#</a>基于 Node.js 的 Express</h4><p>对于 Node.js/Express，请考虑使用 <a href="https://github.com/bripkens/connect-history-api-fallback">connect-history-api-fallback 中间件</a>。</p><h4 id="Internet-Information-Services-IIS"><a href="#Internet-Information-Services-IIS" class="headerlink" title="#Internet Information Services (IIS)"></a><a href="https://router.vuejs.org/zh/guide/essentials/history-mode.html#internet-information-services-iis">#</a>Internet Information Services (IIS)</h4><ol><li> 安装 <a href="https://www.iis.net/downloads/microsoft/url-rewrite">IIS UrlRewrite</a></li><li> 在你的网站根目录中创建一个 <code>web.config</code> 文件，内容如下：</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">  &lt;system.webServer&gt;</span><br><span class="line">    &lt;rewrite&gt;</span><br><span class="line">      &lt;rules&gt;</span><br><span class="line">        &lt;rule name&#x3D;&quot;Handle History Mode and custom 404&#x2F;500&quot; stopProcessing&#x3D;&quot;true&quot;&gt;</span><br><span class="line">          &lt;match url&#x3D;&quot;(.*)&quot; &#x2F;&gt;</span><br><span class="line">          &lt;conditions logicalGrouping&#x3D;&quot;MatchAll&quot;&gt;</span><br><span class="line">            &lt;add input&#x3D;&quot;&#123;REQUEST_FILENAME&#125;&quot; matchType&#x3D;&quot;IsFile&quot; negate&#x3D;&quot;true&quot; &#x2F;&gt;</span><br><span class="line">            &lt;add input&#x3D;&quot;&#123;REQUEST_FILENAME&#125;&quot; matchType&#x3D;&quot;IsDirectory&quot; negate&#x3D;&quot;true&quot; &#x2F;&gt;</span><br><span class="line">          &lt;&#x2F;conditions&gt;</span><br><span class="line">          &lt;action type&#x3D;&quot;Rewrite&quot; url&#x3D;&quot;&#x2F;&quot; &#x2F;&gt;</span><br><span class="line">        &lt;&#x2F;rule&gt;</span><br><span class="line">      &lt;&#x2F;rules&gt;</span><br><span class="line">    &lt;&#x2F;rewrite&gt;</span><br><span class="line">  &lt;&#x2F;system.webServer&gt;</span><br><span class="line">&lt;&#x2F;configuration&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="Caddy"><a href="#Caddy" class="headerlink" title="#Caddy"></a><a href="https://router.vuejs.org/zh/guide/essentials/history-mode.html#caddy">#</a>Caddy</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rewrite &#123;</span><br><span class="line">    regexp .*</span><br><span class="line">    to &#123;path&#125; &#x2F;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="Firebase-主机"><a href="#Firebase-主机" class="headerlink" title="#Firebase 主机"></a><a href="https://router.vuejs.org/zh/guide/essentials/history-mode.html#firebase-%E4%B8%BB%E6%9C%BA">#</a>Firebase 主机</h4><p>在你的 <code>firebase.json</code> 中加入：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;hosting&quot;: &#123;</span><br><span class="line">    &quot;public&quot;: &quot;dist&quot;,</span><br><span class="line">    &quot;rewrites&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;source&quot;: &quot;**&quot;,</span><br><span class="line">        &quot;destination&quot;: &quot;&#x2F;index.html&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="警告"><a href="#警告" class="headerlink" title="警告"></a>警告</h2><p>给个警告，因为这么做以后，你的服务器就不再返回 404 错误页面，因为对于所有路径都会返回 <code>index.html</code> 文件。为了避免这种情况，你应该在 Vue 应用里面覆盖所有的路由情况，然后在给出一个 404 页面。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const router &#x3D; new VueRouter(&#123;</span><br><span class="line">  mode: &#39;history&#39;,</span><br><span class="line">  routes: [</span><br><span class="line">    &#123; path: &#39;*&#39;, component: NotFoundComponent &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>或者，如果你使用 Node.js 服务器，你可以用服务端路由匹配到来的 URL，并在没有匹配到路由的时候返回 404，以实现回退。更多详情请查阅 <a href="https://ssr.vuejs.org/zh/">Vue 服务端渲染文档</a>。</p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
          <category> JavaScript </category>
          
          <category> Vue </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Vue 使用预渲染代替 SSR</title>
      <link href="2020/04/04/Vue%20%E4%BD%BF%E7%94%A8%E9%A2%84%E6%B8%B2%E6%9F%93%E4%BB%A3%E6%9B%BF%20SSR/"/>
      <url>2020/04/04/Vue%20%E4%BD%BF%E7%94%A8%E9%A2%84%E6%B8%B2%E6%9F%93%E4%BB%A3%E6%9B%BF%20SSR/</url>
      
        <content type="html"><![CDATA[<h1 id="页面渲染方式"><a href="#页面渲染方式" class="headerlink" title="页面渲染方式"></a>页面渲染方式</h1><p>前段时间了解到页面有几种渲染方式：SPA SSR，以前写的一个网站但是用的渲染方式是SPA，导致搜索引擎爬虫抓不到任何信息，对SEO优化不很好，本想改成SSR，但是改动配置很多，弄来弄去怕影响开发，今天在Vue官网看到预渲染，今天试了下，感觉是一个折中的方法，而且配置改动不大，大家可以试试</p><h2 id="什么是服务器端渲染-SSR-？"><a href="#什么是服务器端渲染-SSR-？" class="headerlink" title="什么是服务器端渲染 (SSR)？"></a>什么是服务器端渲染 (SSR)？</h2><p>Vue.js 是构建客户端应用程序的框架。默认情况下，可以在浏览器中输出 Vue 组件，进行生成 DOM 和操作 DOM。然而，也可以将同一个组件渲染为服务器端的 HTML 字符串，将它们直接发送到浏览器，最后将这些静态标记”激活”为客户端上完全可交互的应用程序。</p><p>服务器渲染的 Vue.js 应用程序也可以被认为是”同构”或”通用”，因为应用程序的大部分代码都可以在<strong>服务器</strong>和<strong>客户端</strong>上运行。</p><h2 id="为什么使用服务器端渲染-SSR-？"><a href="#为什么使用服务器端渲染-SSR-？" class="headerlink" title="为什么使用服务器端渲染 (SSR)？"></a>为什么使用服务器端渲染 (SSR)？</h2><p>与传统 SPA (单页应用程序 (Single-Page Application)) 相比，服务器端渲染 (SSR) 的优势主要在于：</p><ul><li><p>更好的 SEO，由于搜索引擎爬虫抓取工具可以直接查看完全渲染的页面。</p><p>  请注意，截至目前，Google 和 Bing 可以很好对同步 JavaScript 应用程序进行索引。在这里，同步是关键。如果你的应用程序初始展示 loading 菊花图，然后通过 Ajax 获取内容，抓取工具并不会等待异步完成后再行抓取页面内容。也就是说，如果 SEO 对你的站点至关重要，而你的页面又是异步获取内容，则你可能需要服务器端渲染(SSR)解决此问题。</p></li><li><p>  更快的内容到达时间 (time-to-content)，特别是对于缓慢的网络情况或运行缓慢的设备。无需等待所有的 JavaScript 都完成下载并执行，才显示服务器渲染的标记，所以你的用户将会更快速地看到完整渲染的页面。通常可以产生更好的用户体验，并且对于那些「内容到达时间(time-to-content) 与转化率直接相关」的应用程序而言，服务器端渲染 (SSR) 至关重要。</p></li></ul><p>使用服务器端渲染 (SSR) 时还需要有一些权衡之处：</p><ul><li><p>  开发条件所限。浏览器特定的代码，只能在某些生命周期钩子函数 (lifecycle hook) 中使用；一些外部扩展库 (external library) 可能需要特殊处理，才能在服务器渲染应用程序中运行。</p></li><li><p>  涉及构建设置和部署的更多要求。与可以部署在任何静态文件服务器上的完全静态单页面应用程序 (SPA) 不同，服务器渲染应用程序，需要处于 Node.js server 运行环境。</p></li><li><p>  更多的服务器端负载。在 Node.js 中渲染完整的应用程序，显然会比仅仅提供静态文件的 server 更加大量占用 CPU 资源 (CPU-intensive - CPU 密集)，因此如果你预料在高流量环境 (high traffic) 下使用，请准备相应的服务器负载，并明智地采用缓存策略。</p></li></ul><p>在对你的应用程序使用服务器端渲染 (SSR) 之前，你应该问的第一个问题是，是否真的需要它。这主要取决于内容到达时间 (time-to-content) 对应用程序的重要程度。例如，如果你正在构建一个内部仪表盘，初始加载时的额外几百毫秒并不重要，这种情况下去使用服务器端渲染 (SSR) 将是一个小题大作之举。然而，内容到达时间 (time-to-content) 要求是绝对关键的指标，在这种情况下，服务器端渲染 (SSR) 可以帮助你实现最佳的初始加载性能。</p><h2 id="服务器端渲染-vs-预渲染-SSR-vs-Prerendering"><a href="#服务器端渲染-vs-预渲染-SSR-vs-Prerendering" class="headerlink" title="服务器端渲染 vs 预渲染 (SSR vs Prerendering)"></a>服务器端渲染 vs 预渲染 (SSR vs Prerendering)</h2><p>如果你调研服务器端渲染 (SSR) 只是用来改善少数营销页面（例如 <code>/</code>, <code>/about</code>, <code>/contact</code> 等）的 SEO，那么你可能需要<strong>预渲染</strong>。无需使用 web 服务器实时动态编译 HTML，而是使用预渲染方式，在构建时 (build time) 简单地生成针对特定路由的静态 HTML 文件。优点是设置预渲染更简单，并可以将你的前端作为一个完全静态的站点。</p><p>如果你使用 webpack，你可以使用 <a href="https://github.com/chrisvfritz/prerender-spa-plugin">prerender-spa-plugin</a> 轻松地添加预渲染。它已经被 Vue 应用程序广泛测试 - 事实上，<a href="https://github.com/chrisvfritz">作者</a>是 Vue 核心团队的成员。</p><h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><ul><li>vue-router必须是history模式<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">  mode: <span class="string">&#x27;history&#x27;</span>,</span><br><span class="line">  routes: [...]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li>安装预渲染核心：prerender-spa-plugin<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add prerender-spa-plugin -D</span><br></pre></td></tr></table></figure></li><li>在vue.config.js配置（低版本vue写在build/webpack.prod.conf.js）<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> PrerenderSPAPlugin = <span class="built_in">require</span>(<span class="string">&#x27;prerender-spa-plugin&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> Renderer = PrerenderSPAPlugin.PuppeteerRenderer</span><br><span class="line"><span class="built_in">module</span>.exports=&#123;</span><br><span class="line"><span class="comment">// 因为高版本Vue将配置文件整合到了vue.config.js,所以原先写在webpack配置里的都需要写在configureWebpack里</span></span><br><span class="line">configureWebpack: &#123;</span><br><span class="line"><span class="comment">// plugins插件里书写</span></span><br><span class="line">plugins: [</span><br><span class="line">   <span class="keyword">new</span> PrerenderSPAPlugin(&#123;</span><br><span class="line">  <span class="comment">// 生成文件的路径，这个目录只能有一级。若目录层次大于一级，在生成的时候不会有任何错误提示，在预渲染的时候只会卡着不动</span></span><br><span class="line">  staticDir: path.join(__dirname, <span class="string">&#x27;./dist&#x27;</span>),</span><br><span class="line">  <span class="comment">// 对应自己的路由文件</span></span><br><span class="line">  routes: [ <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;/article&#x27;</span>],</span><br><span class="line">  <span class="comment">// 若没有这段则不会进行预编译</span></span><br><span class="line">  renderer: <span class="keyword">new</span> Renderer(&#123;</span><br><span class="line">inject: &#123;</span><br><span class="line">  foo: <span class="string">&#x27;bar&#x27;</span></span><br><span class="line">&#125;,</span><br><span class="line">headless: <span class="literal">false</span>,</span><br><span class="line"><span class="comment">// 在 main.js 中 document.dispatchEvent(new Event(&#x27;render-event&#x27;))，两者的事件名称要对应上。</span></span><br><span class="line">renderAfterDocumentEvent: <span class="string">&#x27;render-event&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;),</span><br><span class="line">]</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>在mian.js配置，在mounted函数里增加 document.dispatchEvent(new Event(‘render-event’))<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">  router,</span><br><span class="line">  store,</span><br><span class="line">  render:<span class="function"><span class="params">h</span>=&gt;</span>h(App),</span><br><span class="line">  <span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="built_in">document</span>.dispatchEvent(<span class="keyword">new</span> Event(<span class="string">&#x27;render-event&#x27;</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li>yarn run build打包项目，看到自己的页面被提前生成就OK了<br><img src="https://cdn.learnku.com/uploads/images/202007/01/34227/XGcGC8cx0B.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202007/01/34227/XGcGC8cx0B.png!large" srcset="data:image/png;base64,666"></li></ul><h4 id="安装vue-meta-info插件，网页meta标签"><a href="#安装vue-meta-info插件，网页meta标签" class="headerlink" title="安装vue-meta-info插件，网页meta标签"></a>安装vue-meta-info插件，网页meta标签</h4><ul><li>yarn安装<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add vue-meta-info</span><br></pre></td></tr></table></figure></li><li>在mian.js配置<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> MetaInfo <span class="keyword">from</span> <span class="string">&#x27;vue-meta-info&#x27;</span> </span><br><span class="line">Vue.use(MetaInfo)</span><br></pre></td></tr></table></figure></li><li>在XXOO.vue文件中配置<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">    &#x2F;&#x2F; 这些代码会转成网页的meta标签里的内容</span><br><span class="line">    metaInfo: &#123;</span><br><span class="line">        title: &#39;标题&#39;,</span><br><span class="line">        meta: [</span><br><span class="line">            &#123;</span><br><span class="line">                name: &#39;keywords&#39;,</span><br><span class="line">                content: &#39;关键字&#39;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                name: &#39;description&#39;,</span><br><span class="line">                content: &#39;网页描述&#39;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
          <category> JavaScript </category>
          
          <category> Vue </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>axios 拦截器 的使用方法</title>
      <link href="2020/04/04/axios%20%E6%8B%A6%E6%88%AA%E5%99%A8%20%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"/>
      <url>2020/04/04/axios%20%E6%8B%A6%E6%88%AA%E5%99%A8%20%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h4 id="有时候我们需要对axios发送的请求做统一处理，这里就需要使用拦截器"><a href="#有时候我们需要对axios发送的请求做统一处理，这里就需要使用拦截器" class="headerlink" title="有时候我们需要对axios发送的请求做统一处理，这里就需要使用拦截器"></a>有时候我们需要对axios发送的请求做统一处理，这里就需要使用拦截器</h4><ul><li>首先要创建一个axios示例<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="keyword">const</span> $http = axios.create(&#123;</span><br><span class="line">    baseURL: <span class="string">&#x27;/api/&#x27;</span>,</span><br><span class="line">    timeout: <span class="number">5000</span> <span class="comment">// request timeout</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li>请求拦截器,在<b>请求发起之前</b>拦截处理<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// http response 拦截器</span></span><br><span class="line">$http.interceptors.response.use(</span><br><span class="line">    config =&gt; &#123;</span><br><span class="line">        <span class="comment">//拦截请求，做统一处理</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;即将请求数据&#x27;</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(config);</span><br><span class="line">        <span class="keyword">return</span> config</span><br><span class="line">    &#125;,</span><br><span class="line">error =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error) </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li>响应拦截器,在接口返回数据后 <b>响应处理之前</b> 拦截处理<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// http response 拦截器</span></span><br><span class="line">$http.interceptors.response.use(</span><br><span class="line">    response =&gt; &#123;</span><br><span class="line">        <span class="comment">//拦截响应，做统一处理</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;数据请求成功&#x27;</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(response);</span><br><span class="line"><span class="keyword">const</span> res = response.data</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//接口错误状态处理，也就是说无响应时的处理</span></span><br><span class="line">error =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error.response.status) <span class="comment">// 返回接口返回的错误信息</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li>之后就可以把这个axios示例暴露出去，正常使用即可<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> $http</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
          <category> JavaScript </category>
          
          <category> axios </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>MySQL（Oracle）模糊查询 使用 instr () 替代 like 提升效率</title>
      <link href="2020/04/04/MySQL%EF%BC%88Oracle%EF%BC%89%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2%20%E4%BD%BF%E7%94%A8%20instr%20()%20%E6%9B%BF%E4%BB%A3%20like%20%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87/"/>
      <url>2020/04/04/MySQL%EF%BC%88Oracle%EF%BC%89%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2%20%E4%BD%BF%E7%94%A8%20instr%20()%20%E6%9B%BF%E4%BB%A3%20like%20%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87/</url>
      
        <content type="html"><![CDATA[<h4 id="大家都知道like的效率很低，数据量大就会很慢，今天发现了一个内置函数instr-效率比like高"><a href="#大家都知道like的效率很低，数据量大就会很慢，今天发现了一个内置函数instr-效率比like高" class="headerlink" title="大家都知道like的效率很低，数据量大就会很慢，今天发现了一个内置函数instr()效率比like高"></a>大家都知道like的效率很低，数据量大就会很慢，今天发现了一个内置函数instr()效率比like高</h4><ul><li><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> msg_list <span class="keyword">WHERE</span> title <span class="keyword">LIKE</span> <span class="string">&#x27;%涂山%&#x27;</span></span><br></pre></td></tr></table></figure>可以替换为：</li><li><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> msg_list <span class="keyword">WHERE</span> <span class="keyword">INSTR</span>(title,<span class="string">&#x27;涂山&#x27;</span>) &gt; <span class="number">0</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="在-ThinkPHP-Laravel中使用的方法有："><a href="#在-ThinkPHP-Laravel中使用的方法有：" class="headerlink" title="在 ThinkPHP / Laravel中使用的方法有："></a>在 ThinkPHP / Laravel中使用的方法有：</h4><ol><li>使用 whereRaw()执行原生INSTR()</li><li>修改构造查询器（不太推荐，不过用起来方便）<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">项目根目录\thinkphp\library\think\db\Builder.php</span><br></pre></td></tr></table></figure><img src="http://www.thinkphp.cn/Uploads/editor/2017-06-17/594511245fb62.png" class="lazyload" data-srcset="http://www.thinkphp.cn/Uploads/editor/2017-06-17/594511245fb62.png" srcset="data:image/png;base64,666"><br><img src="http://www.thinkphp.cn/Uploads/editor/2017-06-17/5945117c1ca71.png" class="lazyload" data-srcset="http://www.thinkphp.cn/Uploads/editor/2017-06-17/5945117c1ca71.png" srcset="data:image/png;base64,666"><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MsgList::where([</span><br><span class="line"><span class="string">&#x27;title&#x27;</span> =&gt; [<span class="string">&#x27;instr&#x27;</span>,<span class="string">&#x27;涂山&#x27;</span>]</span><br><span class="line">])</span><br><span class="line">-&gt;select();</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
          <category> MySQL </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>PHP7合并运算符和条件运算符的作用和区别</title>
      <link href="2020/04/04/PHP7%E5%90%88%E5%B9%B6%E8%BF%90%E7%AE%97%E7%AC%A6%E5%92%8C%E6%9D%A1%E4%BB%B6%E8%BF%90%E7%AE%97%E7%AC%A6%E7%9A%84%E4%BD%9C%E7%94%A8%E5%92%8C%E5%8C%BA%E5%88%AB/"/>
      <url>2020/04/04/PHP7%E5%90%88%E5%B9%B6%E8%BF%90%E7%AE%97%E7%AC%A6%E5%92%8C%E6%9D%A1%E4%BB%B6%E8%BF%90%E7%AE%97%E7%AC%A6%E7%9A%84%E4%BD%9C%E7%94%A8%E5%92%8C%E5%8C%BA%E5%88%AB/</url>
      
        <content type="html"><![CDATA[<p>我们经常要写类似于这种判断代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 判断是否存在变量</span></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">isset</span>(<span class="variable">$b</span>) ? <span class="variable">$b</span> : <span class="variable">$c</span>;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 判断变量是否为空</span></span><br><span class="line"><span class="variable">$a</span> = !<span class="keyword">empty</span>(<span class="variable">$b</span>) ? <span class="variable">$b</span> : <span class="variable">$c</span>;</span><br></pre></td></tr></table></figure><p>PHP7有了新语法糖，进行简化（<font color="red">PHP版本必须大于7</font>）</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 判断是否存在变量</span></span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$b</span> ?? <span class="variable">$c</span>; <span class="comment">// 等同于 $a = isset($b) ? $b : $c;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 判断变量是否为空</span></span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$b</span> ?: <span class="variable">$c</span>; <span class="comment">// 等同于 $a = !empty($b) ? $b : $c;</span></span><br></pre></td></tr></table></figure><p>他们的区别在</p><ul><li><a href="https://www.runoob.com/php/php-coalescing-operator.html">null合并运算符</a>：?? 判断变量不存在或为NULL</li><li>null条件运算符：?: 则还会判断变量是否为空<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span> = [];</span><br><span class="line">print_r(<span class="variable">$a</span> ?? <span class="string">&#x27;走了这边&#x27;</span>);</span><br><span class="line"><span class="comment">// []</span></span><br><span class="line">print_r(<span class="variable">$a</span> ?: <span class="string">&#x27;走了这边&#x27;</span>);</span><br><span class="line"><span class="comment">// &#x27;走了这边&#x27;</span></span><br></pre></td></tr></table></figure>?? 还会判断是否为NULL<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span> = <span class="literal">null</span>;</span><br><span class="line">print_r(<span class="variable">$a</span> ?? <span class="string">&#x27;走了这边&#x27;</span>);</span><br><span class="line"><span class="comment">// 走了这边</span></span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
          <category> PHP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ThinkPHP 使用命令行 (cli) think 调用</title>
      <link href="2020/04/04/ThinkPHP%20%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%20(cli)%20think%20%E8%B0%83%E7%94%A8%20/"/>
      <url>2020/04/04/ThinkPHP%20%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%20(cli)%20think%20%E8%B0%83%E7%94%A8%20/</url>
      
        <content type="html"><![CDATA[<h3 id="在某些场景里，我们需要在命令行中调用代码"><a href="#在某些场景里，我们需要在命令行中调用代码" class="headerlink" title="在某些场景里，我们需要在命令行中调用代码"></a>在某些场景里，我们需要在命令行中调用代码</h3><ol><li><p>首先，在application\command目录(目录没有则创建)下新建hello.php：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">command</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">console</span>\<span class="title">Command</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">console</span>\<span class="title">Input</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">console</span>\<span class="title">input</span>\<span class="title">Argument</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">console</span>\<span class="title">input</span>\<span class="title">Option</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">console</span>\<span class="title">Output</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Request</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">hello</span> <span class="keyword">extends</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 重写configure</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@inheritdoc</span>&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">configure</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span></span><br><span class="line">            <span class="comment">// 命令的名字（&quot;think&quot; 后面的部分）</span></span><br><span class="line">            -&gt;setName(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line">            <span class="comment">// 配置一个参数 使用$input-&gt;getArgument(&#x27;username&#x27;)获取</span></span><br><span class="line">            <span class="comment">// -&gt;addArgument(&#x27;username&#x27;)</span></span><br><span class="line">            <span class="comment">// 运行 &quot;php think list&quot; 时的简短描述</span></span><br><span class="line">            -&gt;setDescription(<span class="string">&#x27;定时任务微服务.&#x27;</span>)</span><br><span class="line">            <span class="comment">// 运行命令时使用 &quot;--help&quot; 选项时的完整命令描述</span></span><br><span class="line">            -&gt;setHelp(<span class="string">&quot;定时任务微服务 无参数&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  * 重写execute</span></span><br><span class="line"><span class="comment">     *  * &#123;<span class="doctag">@inheritdoc</span>&#125;</span></span><br><span class="line"><span class="comment">     *  </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> Input $input</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> Output $output</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span>(<span class="params">Input <span class="variable">$input</span>, Output <span class="variable">$output</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;hello world&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>修改application/command.php（没有则创建）</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">return</span> [</span><br><span class="line">    <span class="string">&quot;app\command\hello&quot;</span>,</span><br><span class="line">];</span><br></pre></td></tr></table></figure></li><li><p>cd到项目根目录，在命令行输入</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php think hello</span><br></pre></td></tr></table></figure></li><li><p>OK,成功调用</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hello world</span><br></pre></td></tr></table></figure><p>ThinkPHP6修改了逻辑，看这里：<a href="https://www.kancloud.cn/manual/thinkphp6_0/1037651">https://www.kancloud.cn/manual/thinkphp6_0/1037651</a></p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
          <category> PHP </category>
          
          <category> ThinkPHP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>phpStorm 如何用 FTP,SSH 连接到虚拟机 Linux 系统？</title>
      <link href="2020/04/04/phpStorm%20%E5%A6%82%E4%BD%95%E7%94%A8%20FTP,SSH%20%E8%BF%9E%E6%8E%A5%E5%88%B0%E8%99%9A%E6%8B%9F%E6%9C%BA%20Linux%20%E7%B3%BB%E7%BB%9F%EF%BC%9F/"/>
      <url>2020/04/04/phpStorm%20%E5%A6%82%E4%BD%95%E7%94%A8%20FTP,SSH%20%E8%BF%9E%E6%8E%A5%E5%88%B0%E8%99%9A%E6%8B%9F%E6%9C%BA%20Linux%20%E7%B3%BB%E7%BB%9F%EF%BC%9F/</url>
      
        <content type="html"><![CDATA[<p>首先，需要你新建一个目录，用于存放从服务器下载的项目。然后用phpstorm左上角 file-&gt;open打开。<br>然后<br><img src="https://cdn.learnku.com/uploads/images/202006/28/34227/yawZde8qq8.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/28/34227/yawZde8qq8.png!large" srcset="data:image/png;base64,666" alt="在这里插入图片描述"><br><img src="https://cdn.learnku.com/uploads/images/202006/28/34227/RGNlTptMEi.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/28/34227/RGNlTptMEi.png!large" srcset="data:image/png;base64,666" alt="在这里插入图片描述"><br><img src="https://cdn.learnku.com/uploads/images/202006/28/34227/pJGAcmFGRE.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/28/34227/pJGAcmFGRE.png!large" srcset="data:image/png;base64,666" alt="在这里插入图片描述"></p><p>这里测试是否连接上ftp<br><img src="https://cdn.learnku.com/uploads/images/202006/28/34227/BxRyUxfImy.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/28/34227/BxRyUxfImy.png!large" srcset="data:image/png;base64,666" alt="在这里插入图片描述"><br><img src="https://cdn.learnku.com/uploads/images/202006/28/34227/YLIQoZDD7U.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/28/34227/YLIQoZDD7U.png!large" srcset="data:image/png;base64,666" alt="在这里插入图片描述"><br>如果出现了这种情况，把俩行都去除，然后在<code>Local path</code>，选择你要下载到本地的目录。没有出现就跳过这张图。<br><img src="https://cdn.learnku.com/uploads/images/202006/28/34227/i3wSWNy6kG.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/28/34227/i3wSWNy6kG.png!large" srcset="data:image/png;base64,666" alt="在这里插入图片描述"><br><img src="https://cdn.learnku.com/uploads/images/202006/28/34227/L9mWLgwPeq.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/28/34227/L9mWLgwPeq.png!large" srcset="data:image/png;base64,666" alt="在这里插入图片描述"><br><img src="https://cdn.learnku.com/uploads/images/202006/28/34227/gnAlCRTcCh.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/28/34227/gnAlCRTcCh.png!large" srcset="data:image/png;base64,666" alt="在这里插入图片描述"><br><img src="https://cdn.learnku.com/uploads/images/202006/28/34227/xlsXiEAQ0C.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/28/34227/xlsXiEAQ0C.png!large" srcset="data:image/png;base64,666" alt="在这里插入图片描述"></p><p>我遇到的问题：</p><p>Q：Download from CenterOS failed: could not change to work directory</p><p>A：出现这个问题可能是因为ftp的路径写错了，在你填写 root path 的时候不要写路径，因为你的ftp的账号权限已经到你的文件夹目录了，比如www/html/test.   要是你在root path 这在写一个路径就成为了 www/html/test/www/html/test. 所以就会报错！！</p>]]></content>
      
      
      <categories>
          
          <category> IDE </category>
          
          <category> IDEA </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>apache 与 Nginx 隐藏 index.php 报错 No input file specified. 解决办法 设置伪静态</title>
      <link href="2020/04/04/apache%20%E4%B8%8E%20Nginx%20%E9%9A%90%E8%97%8F%20index.php%20%E6%8A%A5%E9%94%99%20No%20input%20file%20specified.%20%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%20%E8%AE%BE%E7%BD%AE%E4%BC%AA%E9%9D%99%E6%80%81/"/>
      <url>2020/04/04/apache%20%E4%B8%8E%20Nginx%20%E9%9A%90%E8%97%8F%20index.php%20%E6%8A%A5%E9%94%99%20No%20input%20file%20specified.%20%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%20%E8%AE%BE%E7%BD%AE%E4%BC%AA%E9%9D%99%E6%80%81/</url>
      
        <content type="html"><![CDATA[<ul><li>Apache<br>在.htaccess中修改（如果是框架，则在public下的.htaccess）<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;IfModule mod_rewrite.c&gt;</span><br><span class="line">Options +FollowSymlinks -Multiviews</span><br><span class="line">RewriteEngine on</span><br><span class="line">RewriteCond %&#123;REQUEST_FILENAME&#125; !-d</span><br><span class="line">RewriteCond %&#123;REQUEST_FILENAME&#125; !-f</span><br><span class="line">RewriteRule ^(.*)$ index.php [L,E=PATH_INFO:$<span class="number">1</span>]</span><br><span class="line">&lt;/IfModule&gt;</span><br></pre></td></tr></table></figure></li><li>Nginx<br>在nginx.conf里增加一行<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line"><span class="keyword">if</span> (!-e $request_filename) &#123;</span><br><span class="line">rewrite  ^(.*)$  /index.php?s=/$<span class="number">1</span>  last;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>OJBK</li></ul>]]></content>
      
      
      <categories>
          
          <category> 服务器 </category>
          
          <category> Web </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>axios baseURL 的使用方法</title>
      <link href="2020/04/04/axios%20baseURL%20%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"/>
      <url>2020/04/04/axios%20baseURL%20%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<ul><li>每次Api都要填写域名，可以设置一个baseUrl，这样少写点代码，而且后面更换域名时，生产环境和开发环境统一时很有用</li><li>qs.stringify将参数格式化成QueryString，可以不设置</li><li>在main.js中修改：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Vue.prototype.axios = axios.create(&#123;</span><br><span class="line"> baseURL:<span class="string">&#x27;/api/&#x27;</span>,</span><br><span class="line"> transformRequest: [<span class="comment">//对数据转换成类似get传参的模式</span></span><br><span class="line">  data =&gt; qs.stringify(data)</span><br><span class="line"> ]&#125;)</span><br></pre></td></tr></table></figure></li></ul><ul><li>这样axios在发出请求时会自动加上baseURL</li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
          <category> JavaScript </category>
          
          <category> axios </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Vue 跨域问题解决办法 Vue 配置防止跨域 nginx 重定向防止跨域</title>
      <link href="2020/04/04/Vue%20%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%20Vue%20%E9%85%8D%E7%BD%AE%E9%98%B2%E6%AD%A2%E8%B7%A8%E5%9F%9F%20nginx%20%E9%87%8D%E5%AE%9A%E5%90%91%E9%98%B2%E6%AD%A2%E8%B7%A8%E5%9F%9F/"/>
      <url>2020/04/04/Vue%20%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%20Vue%20%E9%85%8D%E7%BD%AE%E9%98%B2%E6%AD%A2%E8%B7%A8%E5%9F%9F%20nginx%20%E9%87%8D%E5%AE%9A%E5%90%91%E9%98%B2%E6%AD%A2%E8%B7%A8%E5%9F%9F/</url>
      
        <content type="html"><![CDATA[<blockquote><h2 id="前后端分离不可避免会遇到跨域问题，可把我烦的想砍人，现在总结几个解决办法让后人不走歪路"><a href="#前后端分离不可避免会遇到跨域问题，可把我烦的想砍人，现在总结几个解决办法让后人不走歪路" class="headerlink" title="前后端分离不可避免会遇到跨域问题，可把我烦的想砍人，现在总结几个解决办法让后人不走歪路"></a>前后端分离不可避免会遇到跨域问题，可把我烦的想砍人，现在总结几个解决办法让后人不走歪路</h2><p>环境：<br>    Vue-cli 4x</p></blockquote><blockquote><h3 id="本地开发跨域问题-配置devServer"><a href="#本地开发跨域问题-配置devServer" class="headerlink" title="本地开发跨域问题 - 配置devServer"></a>本地开发跨域问题 - 配置devServer</h3><blockquote><ol><li>打开根目录的vue.config.js(没有则创建，vue以前的版本有的是写在config/index.js，有的写在webpack.config.js，4x版本统一在vue.config.js)，写入：</li></ol></blockquote></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">devServer:&#123;</span><br><span class="line">    host: <span class="string">&#x27;localhost&#x27;</span>, <span class="comment">// Vue开发项目启动域名</span></span><br><span class="line">  port: <span class="number">8080</span>, <span class="comment">// 端口</span></span><br><span class="line">  https: <span class="literal">false</span>, <span class="comment">// 是否是https</span></span><br><span class="line">  open:<span class="literal">false</span>,</span><br><span class="line">  proxy:&#123;</span><br><span class="line"><span class="string">&#x27;/apiDev&#x27;</span>:&#123;</span><br><span class="line">target: <span class="string">&#x27;http://api.zmxy.com&#x27;</span>, <span class="comment">// 后端API</span></span><br><span class="line">  changeOrigin: <span class="literal">true</span>,</span><br><span class="line">  pathRewrite:&#123;</span><br><span class="line"><span class="string">&#x27;^/apiDev&#x27;</span>:<span class="string">&#x27;&#x27;</span> <span class="comment">// 以apiDev作为前缀</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>npm run serve 重新编译项目，以apiDev开头的URL就会自动转发到<a href="http://api.zmxy.com/">http://api.zmxy.com</a><br>axios使用：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.axios.</span><br><span class="line">get(<span class="string">&#x27;/apiDev/index/index/getDetail&#x27;</span>,&#123;</span><br><span class="line">params: &#123;<span class="attr">id</span>:id&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li></ol><blockquote><h1 id="Nginx重定向转发防止跨域"><a href="#Nginx重定向转发防止跨域" class="headerlink" title="Nginx重定向转发防止跨域"></a>Nginx重定向转发防止跨域</h1><blockquote><ol><li>编辑Nginx配置文件</li></ol></blockquote></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">location /api &#123;</span><br><span class="line">   rewrite  ^.+api/?(.*)$ /$<span class="number">1</span> <span class="keyword">break</span>; <span class="comment">//可选参数，正则验证地址</span></span><br><span class="line">   include  uwsgi_params; <span class="comment">//可选参数，uwsgi是服务器和服务端应用程序的通信协议，规定了怎么把请求转发给应用程序和返回</span></span><br><span class="line">   proxy_pass   https:<span class="comment">//www.api.com; // 此处修改为自己的请求地址，必填</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>重启Nginx<br>axios使用：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.axios.</span><br><span class="line">get(<span class="string">&#x27;/api/index/index/getDetail&#x27;</span>,&#123;</span><br><span class="line">params: &#123;<span class="attr">id</span>:id&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
          <category> JavaScript </category>
          
          <category> Vue </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Vue 跨域问题解决办法 Vue 配置防止跨域 nginx 重定向防止跨域</title>
      <link href="2020/04/04/%E8%A7%A3%E5%86%B3%20win10%20%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8B%E8%BF%90%E8%A1%8C%20python%20%E5%BC%B9%E5%87%BA%20Windows%20%E5%BA%94%E7%94%A8%E5%95%86%E5%BA%97/"/>
      <url>2020/04/04/%E8%A7%A3%E5%86%B3%20win10%20%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8B%E8%BF%90%E8%A1%8C%20python%20%E5%BC%B9%E5%87%BA%20Windows%20%E5%BA%94%E7%94%A8%E5%95%86%E5%BA%97/</url>
      
        <content type="html"><![CDATA[<h3 id="前几天为了体验新版Edge，更新了win10，然后运行python命令结果跳出了win10商店-黑人问号？？？"><a href="#前几天为了体验新版Edge，更新了win10，然后运行python命令结果跳出了win10商店-黑人问号？？？" class="headerlink" title="前几天为了体验新版Edge，更新了win10，然后运行python命令结果跳出了win10商店(黑人问号？？？)"></a>前几天为了体验新版Edge，更新了win10，然后运行python命令结果跳出了win10商店(黑人问号？？？)</h3><h3 id="于是乎查看了下环境变量，发现配置没有问题，我怀疑win10设置了某个变量导致覆盖了我的python-于是在cmd里运行"><a href="#于是乎查看了下环境变量，发现配置没有问题，我怀疑win10设置了某个变量导致覆盖了我的python-于是在cmd里运行" class="headerlink" title="于是乎查看了下环境变量，发现配置没有问题，我怀疑win10设置了某个变量导致覆盖了我的python,于是在cmd里运行"></a>于是乎查看了下环境变量，发现配置没有问题，我怀疑win10设置了某个变量导致覆盖了我的python,于是在cmd里运行</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">where</span> python</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator\AppData\Local\Microsoft\WindowsApps\python.exe</span><br><span class="line">D:\Develop\Program Files\Python\Python38\python.exe</span><br></pre></td></tr></table></figure><h3 id="这个WindowsApps不是win10商店吗，什么时候给我加上的，网上查了下，应该是win10商店配置的环境变量方便用户去下载Microsoft-store的python，这个我不需要，于是我去环境变量处，将我的python目录优先级放在WindowsApps优先级前面"><a href="#这个WindowsApps不是win10商店吗，什么时候给我加上的，网上查了下，应该是win10商店配置的环境变量方便用户去下载Microsoft-store的python，这个我不需要，于是我去环境变量处，将我的python目录优先级放在WindowsApps优先级前面" class="headerlink" title="这个WindowsApps不是win10商店吗，什么时候给我加上的，网上查了下，应该是win10商店配置的环境变量方便用户去下载Microsoft store的python，这个我不需要，于是我去环境变量处，将我的python目录优先级放在WindowsApps优先级前面"></a>这个WindowsApps不是win10商店吗，什么时候给我加上的，网上查了下，应该是win10商店配置的环境变量方便用户去下载Microsoft store的python，这个我不需要，于是我去环境变量处，将我的python目录优先级放在WindowsApps优先级前面</h3><p><img src="https://cdn.learnku.com/uploads/images/202006/15/34227/Ovt9rRjQ9E.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/15/34227/Ovt9rRjQ9E.png!large" srcset="data:image/png;base64,666"></p><h3 id="把python目录放前面"><a href="#把python目录放前面" class="headerlink" title="把python目录放前面"></a>把python目录放前面</h3><p><img src="https://cdn.learnku.com/uploads/images/202006/15/34227/34ebiVGvja.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/15/34227/34ebiVGvja.png!large" srcset="data:image/png;base64,666"></p><h3 id="重启CMD，OJBK"><a href="#重启CMD，OJBK" class="headerlink" title="重启CMD，OJBK"></a>重启CMD，OJBK</h3><p><img src="https://cdn.learnku.com/uploads/images/202006/15/34227/4PseomSxKD.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/15/34227/4PseomSxKD.png!large" srcset="data:image/png;base64,666"></p><blockquote><blockquote><p>这里的%%是解析变量，可以在前面设置好，然后在path目录下把变量名前后加%就可以解析了<br><img src="https://cdn.learnku.com/uploads/images/202006/15/34227/6TdLAjK79s.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/15/34227/6TdLAjK79s.png!large" srcset="data:image/png;base64,666"><br><img src="https://cdn.learnku.com/uploads/images/202006/15/34227/FW2yv2K42F.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/15/34227/FW2yv2K42F.png!large" srcset="data:image/png;base64,666"><br>PS:win10更新把我设置的变量全部换成路径了，这几个也是我刚刚加上的，逼死强迫症，以后再也不更新了</p></blockquote></blockquote>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
          <category> Python </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Linux 添加脚本开机自启动</title>
      <link href="2020/04/04/Linux%20%E6%B7%BB%E5%8A%A0%E8%84%9A%E6%9C%AC%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF%E5%8A%A8/"/>
      <url>2020/04/04/Linux%20%E6%B7%BB%E5%8A%A0%E8%84%9A%E6%9C%AC%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF%E5%8A%A8/</url>
      
        <content type="html"><![CDATA[<p>新更新，直接编辑 /etc/rc.d/rc.local 即可 不在需要自己新建</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/rc.d/rc.local</span><br></pre></td></tr></table></figure><h1 id="使用chkconfig"><a href="#使用chkconfig" class="headerlink" title="使用chkconfig"></a>使用chkconfig</h1><blockquote><ul><li>首先写一个脚本</li></ul></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="comment">#chkconfig:2345 80 90</span></span><br><span class="line"><span class="comment">#decription:autostart</span></span><br><span class="line">nohup ~/frpc_linux_amd64 -t 7693dddbc9cc1413 -s 32 <span class="comment"># mysql</span></span><br></pre></td></tr></table></figure><blockquote><p>#!/bin/sh 是shell脚本的开头<br>#chkconfig:2345 80 90   是设置启动优先级，首先你需要百度下Linux启动级别，这里脚本意思是：脚本应该在级别2、3、4、5中启动，它的开始优先级应该是20，它的停止优先级应该是80，这行没有也没事，会给默认优先级<br>#decription:autostart 是脚本描述，不影响执行，非必须<br>nohup XXX 是我自己需要执行的命令，这里文件路径必须是从根目录开始的绝对路径，不如找不到</p></blockquote><blockquote><p>将其移动到/etc/rc.d/init.d目录</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv sf_ssh_frp.sh /etc/rc.d/init.d/sf_ssh_frp.sh</span><br></pre></td></tr></table></figure><blockquote><p>然后要赋予权限，不然无法执行</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x /etc/rc.d/init.d/sf_ssh_frp.sh</span><br></pre></td></tr></table></figure><blockquote><p>之后就是使用chkconfig来添加开机启动了</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --add sf_ssh_frp.sh</span><br></pre></td></tr></table></figure><blockquote><p>chkconfig 命令：</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --add httpd            <span class="comment"># 添加服务，以便让chkconfig指令管理它</span></span><br><span class="line">chkconfig httpd on               <span class="comment"># 设置开机运行该服务，默认是设置2345等级开机运行服务</span></span><br><span class="line">chkconfig --list                 <span class="comment"># 列出所有被chkconfig管理的服务</span></span><br><span class="line">chkconfig --add httpd            <span class="comment"># 添加指定的服务，让chkconfig指令管理它</span></span><br><span class="line">chkconfig --del httpd            <span class="comment"># 删除指定的服务，不再让chkconfig指令管理它</span></span><br><span class="line">chkconfig httpd on               <span class="comment"># 设置开机运行服务，需要先执行 --add 才能执行该命令</span></span><br><span class="line">chkconfig httpd off              <span class="comment"># 设置开机不运行服务，需要先执行 --add 才能执行该命令</span></span><br><span class="line">chkconfig --level 35 httpd on    <span class="comment"># 设置服务在等级3和5时开机运行服务，默认是设置2345等级开机运行服务</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --list                                      <span class="comment"># 等级0：关机</span></span><br><span class="line">atop            0:off   1:off   2:off   3:off   4:off   5:off   6:off     <span class="comment"># 等级1：单用户模式/救援模式</span></span><br><span class="line">auditd          0:off   1:off   2:off   3:off   4:on    5:off   6:off     <span class="comment"># 等级2：无网络连接的多用户命令行模式</span></span><br><span class="line">crond           0:off   1:off   2:on    3:on    4:on    5:on    6:off     <span class="comment"># 等级3：有网络连接的多用户命令行模式</span></span><br><span class="line">ipset           0:off   1:off   2:on    3:on    4:on    5:on    6:off     <span class="comment"># 等级4：不可用</span></span><br><span class="line">iptables        0:off   1:off   2:off   3:off   4:on    5:off   6:off     <span class="comment"># 等级5：带图形界面的多用户模式</span></span><br><span class="line">mysql           0:off   1:off   2:on    3:on    4:on    5:on    6:off     <span class="comment"># 等级6：重启</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 服务器 </category>
          
          <category> Linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>frp 实现内网穿透（Windows 版）</title>
      <link href="2020/04/04/phpstorm%20%E4%BD%BF%E7%94%A8%20Xdebug%20%E8%B0%83%E8%AF%95%E4%BB%A3%E7%A0%81/"/>
      <url>2020/04/04/phpstorm%20%E4%BD%BF%E7%94%A8%20Xdebug%20%E8%B0%83%E8%AF%95%E4%BB%A3%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<h1 id="配置-frp-实现内网穿透"><a href="#配置-frp-实现内网穿透" class="headerlink" title="配置 frp 实现内网穿透"></a>配置 frp 实现内网穿透</h1><p>frp 中文文档：<a href="https://github.com/fatedier/frp/blob/master/README_zh.md">https://github.com/fatedier/frp/blob/master/README_zh.md</a></p><p>一、frp 的作用</p><p>    利用处于内网或防火墙后的机器，对外网环境提供 http 或 https 服务。</p><p>    对于 http, https 服务支持基于域名的虚拟主机，支持自定义域名绑定，使多个域名可以共用一个80端口。</p><p>    利用处于内网或防火墙后的机器，对外网环境提供 tcp 和 udp 服务，例如在家里通过 ssh 访问处于公司内网环境内的主机。</p><p>二、安装 frp</p><p>1. github下载地址：<a href="https://github.com/fatedier/frp/releases">https://github.com/fatedier/frp/releases</a></p><p>   公网、内网服务器都下载一份。</p><p><img src="https://cdn.learnku.com/uploads/images/202006/05/34227/V8d7lKRevc.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/05/34227/V8d7lKRevc.png!large" srcset="data:image/png;base64,666"><br>找到第一条，然后下载frp_windwos_amd64.zip这个(amd64是64系统,386是32位系统，现在电脑基本64位了)，比如图片上的<a href="https://github.com/fatedier/frp/releases/download/v0.33.0/frp_0.33.0_windows_amd64.zip">frp_0.33.0_windows_amd64.zip</a></p><p>2、将frp_0.33.0_windows_amd64.zip解压至任意目录</p><p>3、进入解压目录这里所有 frpc 开头的文件都是客户端文件，所以全部删了，我们服务器只需要 frps 开头的文件<br><img src="https://cdn.learnku.com/uploads/images/202006/05/34227/x1YyH5irtN.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/05/34227/x1YyH5irtN.png!large" srcset="data:image/png;base64,666"><br><img src="https://cdn.learnku.com/uploads/images/202006/05/34227/odaQAGg6MW.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/05/34227/odaQAGg6MW.png!large" srcset="data:image/png;base64,666"></p><p>4、配置服务端（公网服务器）<br>我们打开frps.ini（我用的notepad++编辑器，记事本也可以）<br><font color="red">注意配置文件不支持注释，请不要把汉字复制进去</font></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">bind_port = <span class="number">7000</span>           #与客户端绑定的进行通信的端口</span><br><span class="line">vhost_http_port = <span class="number">6081</span>     #访问客户端web服务自定义的端口号</span><br></pre></td></tr></table></figure><p><img src="https://cdn.learnku.com/uploads/images/202006/06/34227/OyRcAXZViQ.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/06/34227/OyRcAXZViQ.png!large" srcset="data:image/png;base64,666"></p><p>保存然后打开cmd进入当前目录（cmd不会用自行百度），输入：frps.exe  -c ./frps.ini，此时会提示网络防火墙安全警告，点允许<br><img src="https://cdn.learnku.com/uploads/images/202006/05/34227/aPLZULPGp4.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/05/34227/aPLZULPGp4.png!large" srcset="data:image/png;base64,666"><br>提示 start frps success则服务启动成功<br><img src="https://cdn.learnku.com/uploads/images/202006/05/34227/IaVLgIaxis.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/05/34227/IaVLgIaxis.png!large" srcset="data:image/png;base64,666"><br><font color="red">警告：云服务器一定要开放端口，不会开放自行百度，图中的7000是frp绑定的默认端口要打开，另外一个是http（用不到可以删了）</font><br><img src="https://cdn.learnku.com/uploads/images/202006/05/34227/vsJNvzCYCM.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/05/34227/vsJNvzCYCM.png!large" srcset="data:image/png;base64,666"></p><h3 id="至此服务端配置完成！"><a href="#至此服务端配置完成！" class="headerlink" title="至此服务端配置完成！"></a>至此服务端配置完成！</h3><p>5、配置客户端（内网服务器），首先删掉 frps 开头文件文件,然后再进行配置，编辑 frpc.ini<br><font color="red">注意配置文件不支持注释，请不要把汉字复制进去</font></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr = <span class="number">155.94</span><span class="number">.169</span><span class="number">.143</span>   #公网服务器ip</span><br><span class="line">server_port = <span class="number">7000</span>            #与服务端bind_port一致</span><br><span class="line"></span><br><span class="line">[yclj]</span><br><span class="line">type = tcp</span><br><span class="line">local_ip = <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">local_port = <span class="number">3389</span> # <span class="number">3389</span>是windows的远程连接端口</span><br><span class="line">remote_port = <span class="number">24567</span> # 远程服务器端口（自定义）</span><br></pre></td></tr></table></figure><p><img src="https://cdn.learnku.com/uploads/images/202006/06/34227/WwUDslb5Wm.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/06/34227/WwUDslb5Wm.png!large" srcset="data:image/png;base64,666"><br>保存然后执行<br>windows 使用cmd或者powershell进入当前目录，执行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;frpc.exe -c .&#x2F;frpc.ini</span><br></pre></td></tr></table></figure><p>6、访问方式<br>(1) 远程连接windows bind_post要绑定3389，其他的不行<br>ip：155.94.169.143:24567 （这个是服务器开放的端口，映射本地的3389）</p><p>三、结尾</p><p>1.客户端连接服务端提示访问被拒绝，则需要服务端开放防火墙端口（学习的话全开就行了，生产环境除外）。</p><p>2.其他功能请阅读 frp 中文文档：<a href="https://github.com/fatedier/frp/blob/master/README_zh.md">https://github.com/fatedier/frp/blob/master/README_zh.md</a></p>]]></content>
      
      
      <categories>
          
          <category> 内网穿透 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>update-alternatives 使用详解</title>
      <link href="2020/04/04/update-alternatives%20%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3/"/>
      <url>2020/04/04/update-alternatives%20%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>update-alternatives 命令用于处理 Linux 系统中软件版本的切换，使其多版本共存。alternatives 的管理目录 <font color="red">/etc/alternatives</font> 。</p><blockquote><p>alternatives 管理方式</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ ls -l /usr/bin/python</span><br><span class="line">lrwxrwxrwx 1 root root 24 1120  2017 /usr/bin/python -&gt; /etc/alternatives/python</span><br><span class="line">$ ls -l /etc/alternatives/python</span><br><span class="line">lrwxrwxrwx 1 root root 18 1121  2017 /etc/alternatives/python -&gt; /usr/bin/python2.7</span><br></pre></td></tr></table></figure><p>python 这个可执行命令实际是一个链接，指向了 <font color="red">/etc/alternatives/python</font> 。而这个也是一个链接，指向了 <font color="red">/usr/bin/python2.7</font> ，这才是最终的可执行文件。alternatives 实际上是通过软链接的方式对版本进行管理。<br>语法：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$ update-alternatives --<span class="built_in">help</span></span><br><span class="line">用法：update-alternatives [&lt;选项&gt; ...] &lt;命令&gt;</span><br><span class="line"></span><br><span class="line">命令：</span><br><span class="line">  --install &lt;链接&gt; &lt;名称&gt; &lt;路径&gt; &lt;优先级&gt;</span><br><span class="line">    [--slave &lt;链接&gt; &lt;名称&gt; &lt;路径&gt;] ...</span><br><span class="line">                           在系统中加入一组候选项。</span><br><span class="line">  --remove &lt;名称&gt; &lt;路径&gt;   从 &lt;名称&gt; 替换组中去除 &lt;路径&gt; 项。</span><br><span class="line">  --remove-all &lt;名称&gt;      从替换系统中删除 &lt;名称&gt; 替换组。</span><br><span class="line">  --auto &lt;名称&gt;            将 &lt;名称&gt; 的主链接切换到自动模式。</span><br><span class="line">  --display &lt;名称&gt;         显示关于 &lt;名称&gt; 替换组的信息。</span><br><span class="line">  --query &lt;名称&gt;           机器可读版的 --display &lt;名称&gt;.</span><br><span class="line">  --list &lt;名称&gt;            列出 &lt;名称&gt; 替换组中所有的可用候选项。</span><br><span class="line">  --get-selections         列出主要候选项名称以及它们的状态。</span><br><span class="line">  --set-selections         从标准输入中读入候选项的状态。</span><br><span class="line">  --config &lt;名称&gt;          列出 &lt;名称&gt; 替换组中的可选项，并就使用其中哪一个，征询用户的意见。</span><br><span class="line">  --<span class="built_in">set</span> &lt;名称&gt; &lt;路径&gt;      将 &lt;路径&gt; 设置为 &lt;名称&gt; 的候选项。</span><br><span class="line">  --all                    对所有可选项一一调用 --config 命令。</span><br><span class="line"></span><br><span class="line">&lt;链接&gt; 是指向 /etc/alternatives/&lt;名称&gt; 的符号链接。(如 /usr/bin/pager)</span><br><span class="line">&lt;名称&gt; 是该链接替换组的主控名。(如 pager)</span><br><span class="line">&lt;路径&gt; 是候选项目标文件的位置。(如 /usr/bin/less)</span><br><span class="line">&lt;优先级&gt; 是一个整数，在自动模式下，这个数字越高的选项，其优先级也就越高。</span><br><span class="line">..........</span><br></pre></td></tr></table></figure><p><strong>实例</strong></p><ul><li>display 参数显示关于 Python 替换组的信息<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ update-alternatives --display python </span><br><span class="line">python - 手动模式</span><br><span class="line">link best version is /usr/bin/python3.5</span><br><span class="line">链接目前指向 /usr/bin/python2.7</span><br><span class="line">link python is /usr/bin/python</span><br><span class="line">/usr/bin/python2.7 - 优先级 1</span><br><span class="line">/usr/bin/python3.5 - 优先级 2</span><br></pre></td></tr></table></figure></li><li>选择候选项<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ update-alternatives --config python    </span><br></pre></td></tr></table></figure><img src="https://cdn.learnku.com/uploads/images/202006/05/34227/Adsoi1cJqP.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/05/34227/Adsoi1cJqP.png!large" srcset="data:image/png;base64,666"></li><li>install 参数用于添加一个命令的link值<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加 python link</span></span><br><span class="line">$ update-alternatives --install /usr/bin/python python /usr/bin/python2.7 2</span><br><span class="line"><span class="comment"># 第一个参数: --install 表示向update-alternatives注册服务名。</span></span><br><span class="line"><span class="comment"># 第二个参数: 注册最终地址，成功后将会把命令在这个固定的目的地址做真实命令的软链，以后管理就是管理这个软链；</span></span><br><span class="line"><span class="comment"># 第三个参数: 服务名，以后管理时以它为关联依据。</span></span><br><span class="line"><span class="comment"># 第四个参数: 被管理的命令绝对路径。</span></span><br><span class="line"><span class="comment"># 第五个参数: 优先级，数字越大优先级越高。</span></span><br></pre></td></tr></table></figure></li><li>remove 参数用于删除一个命令的link值，其附带的slave也将一起删除<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ update-alternatives –remove python /usr/bin/python2.7</span><br></pre></td></tr></table></figure></li></ul><p>转载于：<a href="https://www.jianshu.com/p/4d27fa2dce86">https://www.jianshu.com/p/4d27fa2dce86</a></p>]]></content>
      
      
      <categories>
          
          <category> 服务器 </category>
          
          <category> Linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Linux 虚拟机使用 xshell 连接 (debian、kali、CentOS)</title>
      <link href="2020/04/04/Linux%20%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BD%BF%E7%94%A8%20xshell%20%E8%BF%9E%E6%8E%A5%20(debian%E3%80%81kali%E3%80%81CentOS)/"/>
      <url>2020/04/04/Linux%20%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BD%BF%E7%94%A8%20xshell%20%E8%BF%9E%E6%8E%A5%20(debian%E3%80%81kali%E3%80%81CentOS)/</url>
      
        <content type="html"><![CDATA[<ol><li><p>首先要确认ip地址，使用ifconfig或者ip addr查看IP地址（一般网卡名是eth0）<br><img src="https://cdn.learnku.com/uploads/images/202006/04/34227/KDgu9Df26M.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/04/34227/KDgu9Df26M.png!large" srcset="data:image/png;base64,666"></p></li><li><p>如果没有eth0或者ipv4的地址的话，需要开启网卡</p><blockquote><blockquote><ol><li>确保vmware左上角–虚拟机–可移动设备–网络设备–设置中切换网络连接方式 NAT或者桥接模式</li><li>编辑/etc/network/interfaces文件</li></ol></blockquote></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/network/interfaces</span><br></pre></td></tr></table></figure><blockquote><blockquote><ol start="3"><li>使用vim命令修改这个文件 eth0为dhcp模式(我设置静态IP老失败，还是动态分配吧)<br><img src="https://cdn.learnku.com/uploads/images/202006/04/34227/rHLjYsTgw5.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/04/34227/rHLjYsTgw5.png!large" srcset="data:image/png;base64,666"></li><li>重启网卡</li></ol></blockquote></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/networking restart</span><br><span class="line">ifconfig eth0 down</span><br><span class="line">ifconfig eth0 up</span><br></pre></td></tr></table></figure></li><li><p>开启SSH，首先打开配置文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure></li><li><p>需要找到 PasswordAuthentication 这一行，按”i”进入输入模式，去掉PasswordAuthentication前面的#号，如果后面是”no”则修改为”yes”<br><img src="https://cdn.learnku.com/uploads/images/202006/04/34227/WJUlhR3S81.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/04/34227/WJUlhR3S81.png!large" srcset="data:image/png;base64,666"><br><img src="https://cdn.learnku.com/uploads/images/202006/04/34227/CWz2CsdwOE.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202006/04/34227/CWz2CsdwOE.png!large" srcset="data:image/png;base64,666"></p></li><li><p>wp保存后，输入service ssh start 开启ssh，</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service ssh start</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update-rc.d ssh <span class="built_in">enable</span> <span class="comment"># 设置ssh开机自启动</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update-rc.d ssh disabled <span class="comment"># 关闭自启动</span></span><br></pre></td></tr></table></figure></li><li><p>之后用Xshell连接linux就不用教了吧~~~</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 服务器 </category>
          
          <category> Linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>PHP xml 转数组 数组转 xml 操作</title>
      <link href="2020/04/04/PHP%20xml%20%E8%BD%AC%E6%95%B0%E7%BB%84%20%E6%95%B0%E7%BB%84%E8%BD%AC%20xml%20%E6%93%8D%E4%BD%9C/"/>
      <url>2020/04/04/PHP%20xml%20%E8%BD%AC%E6%95%B0%E7%BB%84%20%E6%95%B0%E7%BB%84%E8%BD%AC%20xml%20%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<blockquote><h1 id="XML转数组"><a href="#XML转数组" class="headerlink" title="XML转数组"></a>XML转数组</h1><blockquote><h2 id="直接上代码"><a href="#直接上代码" class="headerlink" title="直接上代码"></a>直接上代码</h2></blockquote></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$path</span> = <span class="string">&#x27;./data.xml&#x27;</span>;</span><br><span class="line"><span class="variable">$xml</span> = simplexml_load_file(<span class="variable">$path</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$xml</span>-&gt;children() <span class="keyword">as</span> <span class="variable">$child</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$child</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>simplexml_load_file() 函数把 XML 文档载入对象中。<br>| file | 必需。规定要使用的 XML 文档。 |<br>| class | 可选。规定新对象的 class。 |<br>| options | 可选。规定附加的 Libxml 参数。 |<br>| ns | 可选。 |<br>| is_prefix | 可选。 |<br>返回一个SimpleXMLElement 对象</p><blockquote><blockquote><h2 id="如果是字符串怎么办？"><a href="#如果是字符串怎么办？" class="headerlink" title="如果是字符串怎么办？"></a>如果是字符串怎么办？</h2></blockquote></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$xml</span>=simplexml_load_string(<span class="variable">$note</span>);</span><br><span class="line">print_r(<span class="variable">$xml</span>)</span><br></pre></td></tr></table></figure><blockquote><blockquote><blockquote><p>simplexml_load_string() 函数转换形式良好的 XML 字符串为 SimpleXMLElement 对象。<br>| <em>data</em> | 必需。规定形式良好的 XML 字符串。 |<br>| <em>classname</em> | 可选。规定新对象的 class。 |<br>返回一个SimpleXMLElement 对象</p></blockquote><h2 id="我要的是数组，可不是对象啊"><a href="#我要的是数组，可不是对象啊" class="headerlink" title="我要的是数组，可不是对象啊"></a>我要的是数组，可不是对象啊</h2><p>SimpleXMLElement 对象转换数组,直接强转即可</p></blockquote></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$array</span> = (<span class="keyword">array</span>)<span class="variable">$SimpleXMLElement</span>;</span><br></pre></td></tr></table></figure><blockquote><h1 id="数组转XML"><a href="#数组转XML" class="headerlink" title="数组转XML"></a>数组转XML</h1><blockquote><h2 id="多维数组递归转换XML"><a href="#多维数组递归转换XML" class="headerlink" title="多维数组递归转换XML"></a>多维数组递归转换XML</h2></blockquote></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建新的simpleXML实例，注入内存，确定根节点</span></span><br><span class="line"><span class="variable">$xml</span> = <span class="keyword">new</span> SimpleXMLElement(<span class="string">&#x27;&lt;root/&gt;&#x27;</span>);</span><br><span class="line"><span class="comment">//数组转XML</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">arrayToXml</span>(<span class="params"><span class="variable">$obj</span>, <span class="variable">$array</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$array</span> <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(is_numeric(<span class="variable">$k</span>))</span><br><span class="line">            <span class="variable">$k</span> = <span class="string">&#x27;item&#x27;</span> . <span class="variable">$k</span>;</span><br><span class="line">        <span class="keyword">if</span>(is_array(<span class="variable">$v</span>))&#123;</span><br><span class="line">            <span class="variable">$node</span> = <span class="variable">$obj</span>-&gt;addChild(<span class="variable">$k</span>);</span><br><span class="line">            arrayToXml(<span class="variable">$node</span>, <span class="variable">$v</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$obj</span>-&gt;addChild(<span class="variable">$k</span>, htmlspecialchars(<span class="variable">$v</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><pre><code>6.之后用Xshell连接linux就不用教了吧~~~</code></pre>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
          <category> PHP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Web 服务器显示 no input file specified</title>
      <link href="2020/04/04/Web%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%98%BE%E7%A4%BA%20no%20input%20file%20specified/"/>
      <url>2020/04/04/Web%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%98%BE%E7%A4%BA%20no%20input%20file%20specified/</url>
      
        <content type="html"><![CDATA[<p>今天部署服务器时，显示no input file specified，一度以为是Apache和Nginx的伪静态设置错误，又在另一个服务器试了下，发现没问题，应该是环境配置出了问题，切换了个PHP版本，发现可以了，对比两个版本的php.ini文件，发现以前修改过open_basedir</p><blockquote><p>open_basedir 将php所能打开的文件限制在指定的目录树中，包括文件本身。当程序要使用例如fopen()或file_get_contents()打开一个文件时，这个文件的位置将会被检查。当文件在指定的目录树之外，程序将拒绝打开</p></blockquote><p>将其注释后，问题解决</p>]]></content>
      
      
      <categories>
          
          <category> 服务器 </category>
          
          <category> Web </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>vue 踩坑-This dependency was not found</title>
      <link href="2020/04/04/vue%20%E8%B8%A9%E5%9D%91-This%20dependency%20was%20not%20found/"/>
      <url>2020/04/04/vue%20%E8%B8%A9%E5%9D%91-This%20dependency%20was%20not%20found/</url>
      
        <content type="html"><![CDATA[<h1 id="vue无法引入局部css-Vue-import-Module-not-found"><a href="#vue无法引入局部css-Vue-import-Module-not-found" class="headerlink" title="vue无法引入局部css- Vue @import Module not found"></a>vue无法引入局部css- Vue @import Module not found</h1><p>今天用Vue-cli局部引入一个css，但是一直提示Module not found 或者 This dependency was not found 以为是自己依赖未安装好，装好了Loader也没用，才发现Vue的路径不是从入口文件开始算的，而是从当前组件位置，我一直以为是从main.js开始，才浪费了好多时间</p><p><img src="https://cdn.learnku.com/uploads/images/202005/26/34227/SmV9xqxIbD.png!large" class="lazyload" data-srcset="https://cdn.learnku.com/uploads/images/202005/26/34227/SmV9xqxIbD.png!large" srcset="data:image/png;base64,666" alt="在这里插入图片描述"></p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
          <category> JavaScript </category>
          
          <category> Vue </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Swoole 问题总结</title>
      <link href="2020/04/04/Swoole%20%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/"/>
      <url>2020/04/04/Swoole%20%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h1 id="Swoole问题总结"><a href="#Swoole问题总结" class="headerlink" title="Swoole问题总结"></a>Swoole问题总结</h1><p>官方文档　–　<a href="https://wiki.swoole.com/wiki/page/1.html">https://wiki.swoole.com/wiki/page/1.html</a></p><p>官方错误问题 –  <a href="https://wiki.swoole.com/wiki/page/438.html">https://wiki.swoole.com/wiki/page/438.html</a></p><p>一.安装问题：</p><ol><li>编译问题</li></ol><p>　　(1) 今天部署PHP多版本共存，遇到编译失败error，没有找到php-config，在编译安装swoole时，./configure需要一些参数，完整如下： ./configure –with-php-config=/usr/local/php7/bin/php-config 后边路径请替换成自己的实际路径。</p><p> 　   (2) make: *** [php_swoole_cxx.lo] 错误 1</p><p>　　在执行这一步时</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">　　错误：./configure  --with-php-config=/www/server/php/72/bin/php</span><br></pre></td></tr></table></figure><p>　　指定的是php-config文件，而不是php文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">　　正确：./configure  --with-php-config=/www/server/php/72/bin/php-config</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
          <category> PHP </category>
          
          <category> Swoole </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>PHP 操作 MongoDB</title>
      <link href="2020/04/04/PHP%20%E6%93%8D%E4%BD%9C%20MongoDB/"/>
      <url>2020/04/04/PHP%20%E6%93%8D%E4%BD%9C%20MongoDB/</url>
      
        <content type="html"><![CDATA[<h1 id="PHP操作MongoDB"><a href="#PHP操作MongoDB" class="headerlink" title="PHP操作MongoDB"></a>PHP操作MongoDB</h1><p>PHP的MongoDB驱动中文文档：<a href="https://www.php.cn/manual/view/4.html">https://www.php.cn/manual/view/4.html</a></p><p>PHP的MongoDB驱动官方文档：<a href="https://www.php.net/manual/zh/book.mongodb.php">https://www.php.net/manual/zh/book.mongodb.php</a></p><p>有些细节都没写全，如想学习请阅读官方文档！</p><p>PHP连接MongoDB:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建连接</span></span><br><span class="line"><span class="variable">$manager</span> = <span class="keyword">new</span> MongoDB\Driver\Manager(<span class="string">&#x27;mongodb://localhost:27017&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// MongoDB 写操作类</span></span><br><span class="line"><span class="variable">$bulk</span> = <span class="keyword">new</span> MongoDB\Driver\BulkWrite;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个MongoDB ObjectId，如果传入的是字符串，它将尝试将其转化为ObjectId类型</span></span><br><span class="line"><span class="variable">$id</span> = <span class="keyword">new</span> MongoDB\BSON\ObjectId();</span><br><span class="line"></span><br><span class="line">增删改查:</span><br><span class="line"></span><br><span class="line"><span class="comment">// 增</span></span><br><span class="line"><span class="comment">// MongoDB默认将 _id 当作主键，如果没有它会自动创建，所以这里的_id可以不填</span></span><br><span class="line"><span class="variable">$bulk</span>-&gt;insert([<span class="string">&#x27;_id&#x27;</span>=&gt;<span class="keyword">new</span> MongoDB\BSON\ObjectId, <span class="string">&#x27;name&#x27;</span>=&gt;<span class="string">&#x27;我是遗失的美好灬&#x27;</span>, <span class="string">&#x27;age&#x27;</span>=&gt;<span class="number">18</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// executeBulkWrite() 执行一个或多个写操作 参数一 是命名空间（ 数据库.集合），参数二 是写操作对象 BulkWrite</span></span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$manager</span>-&gt;executeBulkWrite(<span class="string">&#x27;cxfs.hahah&#x27;</span>, <span class="variable">$bulk</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 改</span></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">update()向批量添加更新操作 </span></span><br><span class="line"><span class="comment">参数1：filter 过滤器（为空则匹配所有）</span></span><br><span class="line"><span class="comment">参数2：newObj 新对象，包含更新运算符（例如$set）或替换文档（即只有字段：值表达式）的文档。</span></span><br><span class="line"><span class="comment">参数3：option </span></span><br><span class="line"><span class="comment">      [</span></span><br><span class="line"><span class="comment">         multi: 如果为FALSE，则仅更新第一个匹配的文档，为TRUE更新所有匹配的文档。如果newObj是替换文档，则此选项不能为TRUE。</span></span><br><span class="line"><span class="comment">        upsert：如果过滤器与现有文档不匹配，请插入单个文档。如果文档是替换文档（即没有更新操作符），则将从newObj创建该文档;否则，newObj中的运算符将应用于过滤以创建新文档</span></span><br><span class="line"><span class="comment">      ]</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"> <span class="variable">$bulk</span>-&gt;update(</span><br><span class="line">       [<span class="string">&#x27;age&#x27;</span>=&gt;<span class="number">19</span>, <span class="string">&#x27;hh&#x27;</span>=&gt;<span class="number">2</span>],</span><br><span class="line">       [<span class="string">&#x27;$set&#x27;</span> =&gt; [<span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;菜鸟19号&#x27;</span>]],</span><br><span class="line">       [<span class="string">&#x27;multi&#x27;</span> =&gt; <span class="literal">true</span>, <span class="string">&#x27;upsert&#x27;</span> =&gt; <span class="literal">true</span>]</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="variable">$rs</span> = <span class="variable">$manager</span>-&gt;executeBulkWrite(<span class="string">&#x27;xxj.runoob&#x27;</span>, <span class="variable">$bulk</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删</span></span><br><span class="line">    <span class="variable">$bulk</span>-&gt;delete([<span class="string">&#x27;age&#x27;</span>=&gt;<span class="number">19</span>]);</span><br><span class="line">    <span class="variable">$rs</span> = <span class="variable">$manager</span>-&gt;executeBulkWrite(<span class="string">&#x27;xxj.runoob&#x27;</span>, <span class="variable">$bulk</span>);</span><br><span class="line"><span class="comment">// 查</span></span><br><span class="line">　　<span class="comment">//$filter是删选条件</span></span><br><span class="line">    <span class="variable">$filter</span> = [];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$query</span> = <span class="keyword">new</span> MongoDB\Driver\Query(<span class="variable">$filter</span>);</span><br><span class="line">    <span class="variable">$rs</span> = <span class="variable">$manager</span>-&gt;executeQuery(<span class="string">&#x27;xxj.runoob&#x27;</span>, <span class="variable">$query</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
          <category> PHP </category>
          
          <category> 数据库 </category>
          
          <category> MongoDB </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
